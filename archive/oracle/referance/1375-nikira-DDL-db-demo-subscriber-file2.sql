spool nikira-DDL-db-demo-subscriber-file2.log
set feedback off ;
set serveroutput off ;




CREATE OR REPLACE VIEW SUBSCRIBER_V (
        ACCOUNT_ID,
        ACCOUNT_NAME,
        ACCOUNT_DOA,
        NETWORK_ID,
        FIRST_NAME,
        MIDDLE_NAME,
        LAST_NAME,
        ADDRESS_LINE_1,
        ADDRESS_LINE_2,
        ADDRESS_LINE_3,
        CITY,
        POST_CODE,
        CREDIT_LIMIT,
        RATE_PLAN,
        MODIFIED_DATE,
        SUBSCRIBER_ID,
        PHONE_NUMBER,
        SUBSCRIBER_DOA,
        HOME_PHONE_NUMBER,
        OFFICE_PHONE_NUMBER,
        CONTACT_PHONE_NUMBER,
		CUST_ALERT_EMAIL_ID,
		CUST_ALERT_CONTACT_NUMBER,
        MCN1,
        MCN2,
        IMSI,
        IMEI,
        CONNECTION_TYPE,
        GROUPS,
        NOTIFICATION_GROUPS,
        SERVICES,
        STATUS,
        QOS,
        PRODUCT_TYPE,
        SUBSCRIBER_TYPE,
		SERVICE_NUMBER_TYPE,
		SSID,
		SUBSCRIBER_UID,
		SUBSCRIBER_UID_DOA,
	ID_NUMBER	,	
	DEALER_NAME		,
	DATE_OF_BIRTH	,
	CURRENT_BALANCE	,
	FILE_NAME		,
	DS_NAME			,
	OPTIONAL_FIELD_1	,
	OPTIONAL_FIELD_2	,
	OPTIONAL_FIELD_3	,
	OPTIONAL_FIELD_4	,
	OPTIONAL_FIELD_5	,
	OPTIONAL_FIELD_6	,
	OPTIONAL_FIELD_7	,
	OPTIONAL_FIELD_8	,
	OPTIONAL_FIELD_9	,
	OPTIONAL_FIELD_10	,
	OPTIONAL_FIELD_11	,
	OPTIONAL_FIELD_12	,
	OPTIONAL_FIELD_13	,
	OPTIONAL_FIELD_14	,
	OPTIONAL_FIELD_15	
        )
AS SELECT
        A.ID as ACCOUNT_ID,
        A.ACCOUNT_NAME,
        A.ACCOUNT_DOA,
        S.NETWORK_ID,
        A.FIRST_NAME,
        A.MIDDLE_NAME,
        A.LAST_NAME,
        A.ADDRESS_LINE_1,
        A.ADDRESS_LINE_2,
        A.ADDRESS_LINE_3,
        A.CITY,
        A.POST_CODE,
        A.CREDIT_LIMIT,
        A.RATE_PLAN,
        S.MODIFIED_DATE,
        S.ID as SUBSCRIBER_ID,
        S.PHONE_NUMBER,
        S.SUBSCRIBER_DOA,
        S.HOME_PHONE_NUMBER,
        S.OFFICE_PHONE_NUMBER,
        S.CONTACT_PHONE_NUMBER,
		S.CUST_ALERT_EMAIL_ID,
		S.CUST_ALERT_CONTACT_NUMBER,
        S.MCN1,
        S.MCN2,
        S.IMSI,
        S.IMEI,
        S.CONNECTION_TYPE,
        S.GROUPS,
        S.NOTIFICATION_GROUPS,
        S.SERVICES,
        S.STATUS,
        S.QOS,
        S.PRODUCT_TYPE,
        S.SUBSCRIBER_TYPE,
		S.SERVICE_NUMBER_TYPE,
		S.SSID,
		S.SUBSCRIBER_UID,
		S.SUBSCRIBER_UID_DOA,
		 S.ID_NUMBER	,	
		 S.DEALER_NAME		,
		 S.DATE_OF_BIRTH	,
		 S.CURRENT_BALANCE	,
		 S.FILE_NAME		,
		 S.DS_NAME			,
		 S.OPTIONAL_FIELD_1	,
		 S.OPTIONAL_FIELD_2	,
		 S.OPTIONAL_FIELD_3	,
		 S.OPTIONAL_FIELD_4	,
		 S.OPTIONAL_FIELD_5	,
		 S.OPTIONAL_FIELD_6	,
		 S.OPTIONAL_FIELD_7	,
		 S.OPTIONAL_FIELD_8	,
		 S.OPTIONAL_FIELD_9	,
		 S.OPTIONAL_FIELD_10	,
		 S.OPTIONAL_FIELD_11	,
		 S.OPTIONAL_FIELD_12	,
		 S.OPTIONAL_FIELD_13	,
		 S.OPTIONAL_FIELD_14	,
		 S.OPTIONAL_FIELD_15	
FROM ACCOUNT A, SUBSCRIBER S
WHERE  A.ID = S.ACCOUNT_ID
AND S.SUBSCRIBER_TYPE in (0,1)
AND A.ACCOUNT_TYPE in (0,1)  ;
        
CREATE OR REPLACE VIEW SUBSCRIBER_ACCOUNT_V AS
(
SELECT
        A.ID AS ACCOUNT_ID,
        A.HIERARCHY_ID,
        A.PARENT_ID,
        A.ACCOUNT_TYPE,
        A.ACCOUNT_NAME,
        A.ACCOUNT_DOA,
        A.NETWORK_ID AS ACCOUNT_NETWORK_ID,
        A.FIRST_NAME,
        A.MIDDLE_NAME,
        A.LAST_NAME,
        A.ADDRESS_LINE_1,
        A.ADDRESS_LINE_2,
        A.ADDRESS_LINE_3,
		A.CUST_ALERT_EMAIL_ID AS ACC_CUST_ALERT_EMAIL_ID,
		A.CUST_ALERT_CONTACT_NUMBER AS ACC_CUST_ALERT_PH_NO,
        A.CITY,
        A.POST_CODE,
        A.CREDIT_LIMIT,
        A.RATE_PLAN,
        A.FRD_INDICATOR,
        A.COMMENTS,
        A.GROUPS AS ACCOUNT_GROUPS,
        A.NOTIFICATION_GROUPS AS ACC_NOTF_GROUPS,
        A.MODIFIED_DATE AS ACCOUNT_MODIFIED_DATE,
    S.ID AS SUBSCRIBER_ID,
    S.SUBSCRIBER_TYPE,
    S.PHONE_NUMBER,
    S.SUBSCRIBER_DOA,
    S.HOME_PHONE_NUMBER,
    S.OFFICE_PHONE_NUMBER,
    S.CONTACT_PHONE_NUMBER,
    S.CUST_ALERT_EMAIL_ID,
	S.CUST_ALERT_CONTACT_NUMBER,
    S.MCN1,
    S.MCN2,
    S.IMSI,
    S.IMEI,
    S.CONNECTION_TYPE,
    S.GROUPS AS SUBSCRIBER_GROUPS,
    S.NOTIFICATION_GROUPS AS SUB_NOTF_GROUPS,
    S.SERVICES,
    S.STATUS,
    S.QOS,
    S.PRODUCT_TYPE,
    S.MODIFIED_DATE     AS SUBSCRIBER_MODIFIED_DATE,
    S.NETWORK_ID AS NETWORK_ID,
    S.FIRST_CALL,
    S.SERVICE_NUMBER_TYPE,
    S.SSID,
    S.SUBSCRIBER_UID,
    S.SUBSCRIBER_UID_DOA,
		 S.ID_NUMBER	,	
		 S.DEALER_NAME		,
		 S.DATE_OF_BIRTH	,
		 S.CURRENT_BALANCE	,
		 S.FILE_NAME		,
		 S.DS_NAME			,
		 S.OPTIONAL_FIELD_1	,
		 S.OPTIONAL_FIELD_2	,
		 S.OPTIONAL_FIELD_3	,
		 S.OPTIONAL_FIELD_4	,
		 S.OPTIONAL_FIELD_5	,
		 S.OPTIONAL_FIELD_6	,
		 S.OPTIONAL_FIELD_7	,
		 S.OPTIONAL_FIELD_8	,
		 S.OPTIONAL_FIELD_9	,
		 S.OPTIONAL_FIELD_10	,
		 S.OPTIONAL_FIELD_11	,
		 S.OPTIONAL_FIELD_12	,
		 S.OPTIONAL_FIELD_13	,
		 S.OPTIONAL_FIELD_14	,
		 S.OPTIONAL_FIELD_15	
FROM    
        ACCOUNT A, SUBSCRIBER S
WHERE   
        A.ID = S.ACCOUNT_ID
UNION ALL
SELECT
        PA.ID AS ACCOUNT_ID,
        PA.HIERARCHY_ID,
        PA.PARENT_ID,
        PA.ACCOUNT_TYPE,
        PA.ACCOUNT_NAME,
        PA.ACCOUNT_DOA,
        PA.NETWORK_ID AS ACCOUNT_NETWORK_ID,
        PA.FIRST_NAME,
        PA.MIDDLE_NAME,
        PA.LAST_NAME,
        PA.ADDRESS_LINE_1,
        PA.ADDRESS_LINE_2,
        PA.ADDRESS_LINE_3,
		PA.CUST_ALERT_EMAIL_ID AS ACC_CUST_ALERT_EMAIL_ID,
		PA.CUST_ALERT_CONTACT_NUMBER AS ACC_CUST_ALERT_PH_NO,
        PA.CITY,
        PA.POST_CODE,
        PA.CREDIT_LIMIT,
        PA.RATE_PLAN,
        PA.FRD_INDICATOR,
        PA.COMMENTS,
        PA.GROUPS AS ACCOUNT_GROUPS,
        PA.NOTIFICATION_GROUPS AS ACC_NOTF_GROUPS,
        PA.MODIFIED_DATE AS ACCOUNT_MODIFIED_DATE,
    PS.ID AS SUBSCRIBER_ID,
    PS.SUBSCRIBER_TYPE,
    PS.PHONE_NUMBER,
    PS.SUBSCRIBER_DOA,
    PS.HOME_PHONE_NUMBER,
    PS.OFFICE_PHONE_NUMBER,
    PS.CONTACT_PHONE_NUMBER,
    PS.CUST_ALERT_EMAIL_ID,
	PS.CUST_ALERT_CONTACT_NUMBER,
    PS.MCN1,
    PS.MCN2,
    PS.IMSI,
    PS.IMEI,
    PS.CONNECTION_TYPE,
    PS.GROUPS AS SUBSCRIBER_GROUPS,
    PS.NOTIFICATION_GROUPS AS SUB_NOTF_GROUPS,
    PS.SERVICES,
    PS.STATUS,
    PS.QOS,
    PS.PRODUCT_TYPE,
    PS.MODIFIED_DATE     AS SUBSCRIBER_MODIFIED_DATE,
    PS.NETWORK_ID AS NETWORK_ID,
    PS.FIRST_CALL,
	PS.SERVICE_NUMBER_TYPE,
	PS.SSID,
	PS.SUBSCRIBER_UID,
	PS.SUBSCRIBER_UID_DOA,
		PS.ID_NUMBER	,	
		PS.DEALER_NAME		,
		PS.DATE_OF_BIRTH	,
		PS.CURRENT_BALANCE	,
		PS.FILE_NAME		,
		PS.DS_NAME			,
		PS.OPTIONAL_FIELD_1	,
		PS.OPTIONAL_FIELD_2	,
		PS.OPTIONAL_FIELD_3	,
		PS.OPTIONAL_FIELD_4	,
		PS.OPTIONAL_FIELD_5	,
		PS.OPTIONAL_FIELD_6	,
		PS.OPTIONAL_FIELD_7	,
		PS.OPTIONAL_FIELD_8	,
		PS.OPTIONAL_FIELD_9	,
		PS.OPTIONAL_FIELD_10	,
		PS.OPTIONAL_FIELD_11	,
		PS.OPTIONAL_FIELD_12	,
		PS.OPTIONAL_FIELD_13	,
		PS.OPTIONAL_FIELD_14	,
		PS.OPTIONAL_FIELD_15	
FROM    
        PRECHECK_ACCOUNT PA, PRECHECK_SUBSCRIBER PS
WHERE   
        PA.ID = PS.ACCOUNT_ID
) ;
 
CREATE SEQUENCE ARCHIVED_SUBSCRIBER_SEQ INCREMENT BY 1 START WITH 1025 NOMAXVALUE NOMINVALUE NOCYCLE CACHE 20 ORDER;
CREATE TABLE ARCHIVED_SUBSCRIBER (
        ID                                              NUMBER(20,0) NOT NULL,
        SUBSCRIBER_TYPE                 NUMBER(20,0) DEFAULT 0,
        ACCOUNT_ID                              NUMBER(20,0) NOT NULL,
        ACCOUNT_NAME                    VARCHAR2(40),
        PHONE_NUMBER                    VARCHAR2(40) NOT NULL,
        SUBSCRIBER_DOA                  DATE DEFAULT SYSDATE,
        HOME_PHONE_NUMBER               VARCHAR2(40),
        OFFICE_PHONE_NUMBER             VARCHAR2(40),
        CONTACT_PHONE_NUMBER    VARCHAR2(40),
        MCN1                                    VARCHAR2(40),
        MCN2                                    VARCHAR2(40),
        IMSI                            VARCHAR2(40),
        IMEI                                    VARCHAR2(40),
        CONNECTION_TYPE                 NUMBER(20,0) NOT NULL,
        GROUPS                                  VARCHAR2(256),
        SERVICES                                NUMBER(20,0) DEFAULT 2047,
        STATUS                                  NUMBER(20,0) NOT NULL,
        QOS                                             NUMBER(1,0)  DEFAULT 0,
        PRODUCT_TYPE                    NUMBER(20,0) NOT NULL,
        MODIFIED_DATE                   DATE DEFAULT SYSDATE,
        NETWORK_ID                          NUMBER(21,0) DEFAULT 999,
		SERVICE_NUMBER_TYPE         NUMBER(20) DEFAULT 1 NOT NULL,
		SSID            NUMBER(20) ,
		SUBSCRIBER_UID          VARCHAR2(40),
		SUBSCRIBER_UID_DOA          Date DEFAULT SYSDATE,
	    ID_NUMBER			NUMBER(20),
	    DEALER_NAME			VARCHAR2(256), 
		DATE_OF_BIRTH		DATE,
	    CURRENT_BALANCE			NUMBER(16,6),
	    FILE_NAME			VARCHAR2(256),
	    DS_NAME			VARCHAR2(256),
	    OPTIONAL_FIELD_1			VARCHAR2(256),
	    OPTIONAL_FIELD_2			VARCHAR2(256),
	    OPTIONAL_FIELD_3			VARCHAR2(256),
	    OPTIONAL_FIELD_4			VARCHAR2(256),
	    OPTIONAL_FIELD_5			VARCHAR2(256),
	    OPTIONAL_FIELD_6			VARCHAR2(256),
	    OPTIONAL_FIELD_7			VARCHAR2(256),
	    OPTIONAL_FIELD_8			VARCHAR2(256),
	    OPTIONAL_FIELD_9			VARCHAR2(256),
	    OPTIONAL_FIELD_10			VARCHAR2(256),
	    OPTIONAL_FIELD_11			NUMBER(16,6),
	    OPTIONAL_FIELD_12			NUMBER(16,6),
	    OPTIONAL_FIELD_13			NUMBER(16,6),
	    OPTIONAL_FIELD_14			DATE,
	    OPTIONAL_FIELD_15			DATE,
		CONSTRAINT FK_AR_SUB_SER_NUM_TYP_ID FOREIGN KEY (SERVICE_NUMBER_TYPE) REFERENCES SERVICE_NUMBER_TYPES(ID)
) ;

CREATE INDEX IX_ARCH_SUBSCRIBER_PH_NU ON ARCHIVED_SUBSCRIBER("PHONE_NUMBER") ;
CREATE INDEX IX_ARCH_SUB_ACCOUNT_NAME ON ARCHIVED_SUBSCRIBER("ACCOUNT_NAME") ;
CREATE INDEX IX_ARCH_SUB_ID ON ARCHIVED_SUBSCRIBER("ID") ;
CREATE INDEX IX_ARCH_SUB_NUM_TYPE ON ARCHIVED_SUBSCRIBER("SERVICE_NUMBER_TYPE") ;
CREATE INDEX IX_ARCH_SUB_SSID ON ARCHIVED_SUBSCRIBER("SSID") ;
CREATE INDEX IX_ARCH_SUB_UID ON ARCHIVED_SUBSCRIBER("SUBSCRIBER_UID") ;


COMMIT;
spool off
