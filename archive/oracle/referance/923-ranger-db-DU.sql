-- ********************************************************************************
-- *  Copyright(c) Subexazure Limited 2006. All Rights Reserved.               *
-- *  The copyright to the Computer Program(s) herein is the property of Subex    *
-- *  systems limited. the program(s) may be used and/or copied with the written  *
-- *  permission from subex systems limited or in accordance with the terms and   *
-- *  conditions stipulated in the agreement/contract under which the program(s)  *
-- *  have been supplied.                                                         *
-- ********************************************************************************
SET FEEDBACK OFF

start nikira-db-with-tablespace-CDR.sql
start nikira-db-with-tablespace-RECHARGE.sql	
start nikira-db-with-tablespace-GPRS.sql
start nikira-db-with-tablespace-NETFLOW.sql
start ranger-db-acc_subs.sql

DROP TABLE DU_RECORD_TYPE;

DROP TABLE DU_TAPIN_SERVICE_TYPE;

DROP TABLE DU_GROUP_NAME_CODE;

DROP TABLE DU_RATE_PLAN;

DROP TABLE DU_SUBSCRIBER_SERVICE_MAPPING;

DROP TABLE STATUS_CHECK;
DROP TABLE DU_SERVICE_TIBCO;

drop table  du_white_sub;
drop table DU_WHITE_DEACTIVE;

DROP TABLE DU_RECORD_TYPE_SERVICE_TYPE;
DROP TABLE PARTIAL_CDR_INFO ;

DROP INDEX IX_DU_VOICE_SIM_BOX_SUM_SUBID ;
DROP INDEX IX_DU_VOICE_SIM_BOX_SUM_PHNO ;
DROP TABLE DU_VOICE_SIM_BOX_SUMMARY ;

DROP INDEX IX_DU_SMS_SIM_BOX_SUM_SUBID ;
DROP INDEX IX_DU_SMS_SIM_BOX_SUM_PHNO ;
DROP TABLE DU_SMS_SIM_BOX_SUMMARY ;

DROP TABLE DU_EXCLUDE_FROM_SIM_BOX ;
DROP TABLE DU_CONNECTION_TYPE ;

DROP TABLE DU_RECHARGE_RATE_TYPES ;
DROP TABLE DU_RECHARGE_TYPES ;
DROP TABLE PRS_NUMBER ; 
DROP TABLE DU_MOBILE_CONTENT_SERVICES ;
DROP TABLE DU_NRTRDE_RATE ;

-- DU: Additions Specific to Datasource
DROP TABLE GSM_PREFIX ;
DROP TABLE DUPLICATE_CDR_FILE_CONFIG ;
DROP TABLE DS_ASCII_INPUT_CONFIGURATION ;
DROP TABLE LOCAL_NUMBER CASCADE CONSTRAINTS ;

DROP TABLE DU_SESSION_STATUS;
DROP TABLE DU_VALID_GPRS_RECORD;
DROP TABLE DU_SGSN_ADDRESSES ;
DROP TABLE DU_SERVICE_ID_DESCRIPTION ;
DROP SEQUENCE DU_MC_CHARGING_ID ;

CREATE TABLE DU_RECORD_TYPE (
    BSCS_STREAM 		VARCHAR2(40),
    BSCS_MAP_REF    	VARCHAR2(10),
    VALUE       		NUMBER(10),
    SERVICE_TYPE    	NUMBER(10),
    INROAMER_INDICATOR  VARCHAR2(10),
    TYPE_OF_CALL		VARCHAR2(255),	
    CONSTRAINT PK_DU_RE_TY PRIMARY KEY (BSCS_STREAM, BSCS_MAP_REF)
    ) TABLESPACE TS_NIKIRA ;


CREATE TABLE DU_TAPIN_SERVICE_TYPE (
	VALUE	NUMBER(10),
	SERVICE_TYPE NUMBER(10),
	CONSTRAINT PK_DU_SERVICE_VALUE PRIMARY KEY (VALUE)
	) TABLESPACE TS_NIKIRA ;
CREATE TABLE DU_GROUP_NAME_CODE (
	CODE 		VARCHAR2(10) NOT NULL,
	DESCRIPTION 	VARCHAR2(256),
	SHORT_CODE	VARCHAR2(50),
	CONSTRAINT PK_DU_GROUP_CODE PRIMARY KEY (CODE)
	) TABLESPACE TS_NIKIRA ; 

CREATE TABLE DU_RATE_PLAN (
	CODE 		VARCHAR2(10),
	RATEPLAN	VARCHAR2(256),
	PRODUCT_TYPE NUMBER(10),
	CONSTRAINT PK_DU_RATE_PLAN_CODE PRIMARY KEY (CODE)
	) TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_SUBSCRIBER_SERVICE_MAPPING (
	SERVICE_INPUT	VARCHAR2(50),
	SERVICE_VALUE	NUMBER(10),
	CONSTRAINT PK_DU_SUBSCRIBER_SERVICE PRIMARY KEY (SERVICE_INPUT)
	) TABLESPACE TS_NIKIRA ;

CREATE TABLE STATUS_CHECK (
	STATUS_INPUT 	VARCHAR2(20),
	STATUS_VALUE NUMBER(10),
	CONSTRAINT PK_DU_STATUS_INPUT PRIMARY KEY (STATUS_INPUT)
	) TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_SERVICE_TIBCO (
	ID NUMBER(20) NOT NULL,
	DESCRIPTION VARCHAR2(256)
	) TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_RECORD_TYPE_SERVICE_TYPE (
    INPUT 			VARCHAR2(16),
    RECORD_TYPE 	NUMBER(4),
    SERVICE_TYPE 	NUMBER(4),
    TYPE_OF_CALL 	VARCHAR2(255)
    ) TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_WHITE_SUB
(
    ACCOUNT_ID        Number(10),
    FIRST_NAME        varchar2(40),
    MIDDLE_NAME       varchar2(40),
    LAST_NAME         varchar2(40),
    ADDRESS_LINE1     varchar2(70),
    ADDRESS_LINE2     varchar2(40),
    ADDRESS_LINE3     varchar2(110),
    CONTACT_PHONE_NUMBER      varchar2(25),
    GROUP_NAME        varchar2(10),
    DATE_OF_ACTIVATION    date,
    PHONE_NUMBER      varchar2(25),
    STATUS            varchar2(1),
    IMSI              varchar2(20),
    END_SERVICE_DATE  Date
)  TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_WHITE_DEACTIVE
(
    PHONE_NUMBER    VARCHAR2(25),
    IMSI            VARCHAR2(20),
    ACCOUNT_ID      NUMBER(10)
) TABLESPACE TS_NIKIRA ;

CREATE INDEX IX_SUBSCRIBER_IMSI ON  SUBSCRIBER("IMSI") TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_VOICE_SIM_BOX_SUMMARY
(
	PHONE_NUMBER        VARCHAR2 (40) NOT NULL,
	SUBSCRIBER_ID 		NUMBER(20) NOT NULL,
	OUTGOING_COUNT		NUMBER(10) NOT NULL,
	INCOMING_COUNT		NUMBER(10) NOT NULL,
	FORWARDED_COUNT		NUMBER(10) NOT NULL,
	GEO_POS_COUNT		NUMBER(10) NOT NULL,
	TRAFFIC_DATE		DATE  NOT NULL
)  TABLESPACE TS_NIKIRA ;

CREATE INDEX IX_DU_VOICE_SIM_BOX_SUM_SUBID ON DU_VOICE_SIM_BOX_SUMMARY("SUBSCRIBER_ID")  TABLESPACE TS_NIKIRA ;
CREATE INDEX IX_DU_VOICE_SIM_BOX_SUM_PHNO ON DU_VOICE_SIM_BOX_SUMMARY("PHONE_NUMBER")  TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_SMS_SIM_BOX_SUMMARY
(
	PHONE_NUMBER        VARCHAR2 (40) NOT NULL,
	SUBSCRIBER_ID 		NUMBER(20) NOT NULL,
	OUTGOING_COUNT		NUMBER(10) NOT NULL,
	INCOMING_COUNT		NUMBER(10) NOT NULL,
	FORWARDED_COUNT		NUMBER(10) NOT NULL,
	GEO_POS_COUNT		NUMBER(10) NOT NULL,
	TRAFFIC_DATE		DATE  NOT NULL
)  TABLESPACE TS_NIKIRA ;

CREATE INDEX IX_DU_SMS_SIM_BOX_SUM_SUBID ON DU_SMS_SIM_BOX_SUMMARY("SUBSCRIBER_ID")  TABLESPACE TS_NIKIRA ;
CREATE INDEX IX_DU_SMS_SIM_BOX_SUM_PHNO ON DU_SMS_SIM_BOX_SUMMARY("PHONE_NUMBER")  TABLESPACE TS_NIKIRA ;

create table PARTIAL_CDR_INFO
(
 	PHONE_NUMBER		VARCHAR2 (80),
	CO_RELATION_ID		VARCHAR2 (80),
	TIME_STAMP			VARCHAR2 (80)
)  TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_EXCLUDE_FROM_SIM_BOX
(
	PHONE_NUMBER        VARCHAR2 (40) NOT NULL
)  TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_CONNECTION_TYPE
(
    INPUT   VARCHAR2(256) NOT NULL,
    VALUE   NUMBER(10)	NOT NULL,
    SUBSCRIPTION_TYPE 	 VARCHAR2(15)
)  TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_RECHARGE_RATE_TYPES
(
 	BALANCE_TYPE_ID		VARCHAR2(20)
	CONSTRAINT NN_BALANCE_TYPE_ID NOT NULL,
	DESCRIPTION			VARCHAR2(256),
	RATE				NUMBER(16,4)
	CONSTRAINT NN_RATE NOT NULL,
	DIVISION_FACTOR		NUMBER(16,4) DEFAULT 1
	CONSTRAINT NN_DIVISION_FACTOR NOT NULL,
	CONSTRAINT UK_BALANCE_TYPE_ID UNIQUE (BALANCE_TYPE_ID)
)  TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_RECHARGE_TYPES
(
 	CDR_TYPE			VARCHAR2(256)
	CONSTRAINT NN_CDR_TYPE NOT NULL,
	PATTERN				VARCHAR2(256),
	RECHARGE_TYPE		VARCHAR2(256)
	CONSTRAINT NN_RECHARGE_TYPE NOT NULL
)  TABLESPACE TS_NIKIRA ;

CREATE TABLE PRS_NUMBER
(
	PHONE_NUMBER			VARCHAR2(20),
	DESCRIPTION			VARCHAR2(256)
)  TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_MOBILE_CONTENT_SERVICES
(
	STREAM_ID			VARCHAR2(64),
	CDR_TYPE			NUMBER(2),
	SERVICE_TYPE		VARCHAR2(64),
	CDR_SERVICE_TYPE	NUMBER(2),
	CDR_VALUE			NUMBER(10,4),
	CONSTRAINT PK_ST_ID_CD_TY_SE_TY PRIMARY KEY (STREAM_ID, CDR_TYPE, SERVICE_TYPE)
)  TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_NRTRDE_RATE
(
	VPMN				varchar2(20) NOT NULL,
	DESTINATION_PREFIX	varchar2(40) NOT NULL,
	SERVICE_TYPE		number(10) NOT NULL,
	PULSE				NUMBER(10,2) NOT NULL,
	VALUE_PER_PULSE		NUMBER(20,2) NOT NULL,
	CONSTRAINT PK_DU_NRTRDE_RATE PRIMARY KEY(VPMN,DESTINATION_PREFIX,SERVICE_TYPE)
) TABLESPACE TS_NIKIRA ;

-- DU: Additions Specific to Datasource - START
CREATE TABLE GSM_PREFIX
(
	PREFIX  VARCHAR(20) NOT NULL
) TABLESPACE TS_NIKIRA ;

CREATE TABLE DUPLICATE_CDR_FILE_CONFIG
(
	 DS_TYPE	VARCHAR2(32)    NOT NULL,
	 TIME_BAND	NUMBER(16,6)    NOT NULL,
	 PRIMARY KEY (DS_TYPE)
)  TABLESPACE TS_NIKIRA ;

CREATE TABLE DS_ASCII_INPUT_CONFIGURATION
(
	POSITION        NUMBER(10),
	FIELD_SIZE      NUMBER(10),
	SEQUENCE        NUMBER(10),
	DS_TYPE         NUMBER(10)
)  TABLESPACE TS_NIKIRA ;

-- table contains the local network codes
CREATE TABLE LOCAL_NUMBER
(
	NETWORK_ID          NUMBER(20,0) NOT NULL,
	LOCAL_NUMBER        VARCHAR2(40) NOT NULL,
	IS_LOCAL_NETWORK    NUMBER(20,0),
	CONSTRAINT PK_LO_NU_LO_NU PRIMARY KEY (LOCAL_NUMBER)
)  TABLESPACE TS_NIKIRA ;

-- DU: Additions Specific to Datasource - END

-- Table For determining the SESSION_STATUS
CREATE TABLE DU_SESSION_STATUS (
	CAUSE_FOR_SESSION 			VARCHAR2(10),
	OUTPUT 						NUMBER(10)
	) TABLESPACE TS_NIKIRA ;

-- Table For filtering Invalid GPRS_CDR
CREATE TABLE DU_VALID_GPRS_RECORD (
	FIELD_ID					VARCHAR2(20),
	CDR_TYPE					VARCHAR2(40)
	) TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_SGSN_ADDRESSES(
	DESCRIPTION					VARCHAR2(256),
	SGSN_ADDRESS				VARCHAR2(256)
)  TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_SERVICE_ID_DESCRIPTION(
	SERVICE_ID				VARCHAR2(256),
	DESCRIPTION				VARCHAR2(256)
)  TABLESPACE TS_NIKIRA ;

CREATE SEQUENCE DU_MC_CHARGING_ID INCREMENT BY 1 NOMAXVALUE MINVALUE 1 NOCYCLE CACHE 2000 ORDER;

DROP TABLE DS_FIELD_CONFIG CASCADE CONSTRAINTS ;

CREATE TABLE DS_FIELD_CONFIG (
	NAME 			VARCHAR2(100) NOT NULL, 
	DATA_TYPE 		NUMBER(20,0) NOT NULL, 
	ID 				NUMBER(20,0) NOT NULL,
	POSITION 		NUMBER(20,0) NOT NULL,
	DS_TYPE 		NUMBER(20,0) NOT NULL,
	DATABASE_FIELD 	VARCHAR2(50),
	FORMAT 			VARCHAR2(80) NULL,
	DS_CATEGORY 	VARCHAR2(255),
	IS_VISIBLE		NUMBER(20,0) NOT NULL,
	WIDTH           NUMBER(20,0) DEFAULT 0 NOT NULL
) TABLESPACE TS_NIKIRA ;

CREATE TABLE DU_SS7_DATA (
	KEY				VARCHAR2(50) NOT NULL, 
	VALUE			VARCHAR2(3000) NOT NULL,
	CONSTRAINT PK_KEY PRIMARY KEY(KEY)
) TABLESPACE TS_NIKIRA ;

COMMIT ;
QUIT;
