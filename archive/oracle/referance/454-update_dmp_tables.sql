delete from DU_SGSN_ADDRESSES;
delete from ROAMER_PARTNER;
delete from RATER_SPECIAL_NUMBERS;
delete from CELL_SITE_GEO_POSITIONS;
delete from LOCAL_NUMBER;
delete from DU_SERVICE_ID_DESCRIPTION;
--delete from DS_FIELD_CONFIG;
delete from DU_RECORD_TYPE;
delete from SUBSCRIBER;
delete from DU_RECHARGE_RATE_TYPES;
delete from DU_RECHARGE_TYPES;
delete from DU_OPC_DPC;
delete from PREPAID_SUBSCRIBER;
delete from CLI_SUBSCRIBER_NUMBER_MAP;
--delete from du_nrtrde_rate;
delete from FREE_NUMBERS_NETWORKS ;
delete from FREE_NUMBERS;
delete from ORG_DEST_LINKS;
delete from RATE_PER_CALLS;
delete from TIME_ZONE_RATE_TYPES;
delete from RATE_PLANS;
delete from HOLIDAY_LISTS_NETWORKS ;
delete from HOLIDAY_LISTS;
delete from WEEKENDS;
delete from DEFAULT_RATES;
delete from RCF_INFOS;
delete from NETWORKS_SDR_RATES ;
delete from SDR_RATES;
delete from rating_configuration;
delete from DU_SPECIAL_NUMBERS;
delete from zonecode_countrycode_map;
delete from du_mobile_content_services;
delete from gsm_prefix;
delete from duplicate_cdr_file_config;
delete from cdr_file_detail;
delete from DS_ASCII_INPUT_CONFIGURATION;

insert into DU_SGSN_ADDRESSES SELECT * FROM MIGRATE.DU_SGSN_ADDRESSES;
---
alter table ROAMER_PARTNER drop constraint PK_RM_PR_NW;
---
insert into ROAMER_PARTNER SELECT * FROM MIGRATE.ROAMER_PARTNER;
insert into LOCAL_NUMBER SELECT * FROM MIGRATE.LOCAL_NUMBER;
insert into DU_SERVICE_ID_DESCRIPTION SELECT * FROM MIGRATE.DU_SERVICE_ID_DESCRIPTION;
--insert into DS_FIELD_CONFIG SELECT * FROM MIGRATE.DS_FIELD_CONFIG;
insert into DU_RECORD_TYPE SELECT * FROM MIGRATE.DU_RECORD_TYPE;
insert into DU_RECHARGE_RATE_TYPES SELECT * FROM MIGRATE.DU_RECHARGE_RATE_TYPES;
insert into DU_RECHARGE_TYPES SELECT * FROM MIGRATE.DU_RECHARGE_TYPES;
insert into DU_OPC_DPC SELECT * FROM MIGRATE.DU_OPC_DPC;
insert into PREPAID_SUBSCRIBER SELECT * FROM MIGRATE.PREPAID_SUBSCRIBER;
insert into CLI_SUBSCRIBER_NUMBER_MAP SELECT * FROM MIGRATE.CLI_SUBSCRIBER_NUMBER_MAP;
--insert into du_nrtrde_rate SELECT * FROM MIGRATE.du_nrtrde_rate;
insert into rating_configuration SELECT * FROM MIGRATE.rating_configuration;
insert into DU_SPECIAL_NUMBERS SELECT * FROM MIGRATE.DU_SPECIAL_NUMBERS;
insert into zonecode_countrycode_map SELECT * FROM MIGRATE.zonecode_countrycode_map;
insert into du_mobile_content_services SELECT * FROM MIGRATE.du_mobile_content_services;
insert into gsm_prefix SELECT * FROM MIGRATE.gsm_prefix;
insert into duplicate_cdr_file_config SELECT * FROM MIGRATE.duplicate_cdr_file_config;
insert into cdr_file_detail SELECT * FROM MIGRATE.cdr_file_detail A
	WHERE A.DS_TYPE IS NOT NULL AND A.FILE_NAME IS NOT NULL AND A.TIME_STAMP IS NOT NULL AND A.FILE_SIZE IS NOT NULL ;
insert into DS_ASCII_INPUT_CONFIGURATION SELECT * FROM MIGRATE.DS_ASCII_INPUT_CONFIGURATION;
insert into CELL_SITE_GEO_POSITIONS SELECT * FROM MIGRATE.CELL_SITE_GEO_POSITION;

insert into SUBSCRIBER 
(
	ID,ACCOUNT_ID,PHONE_NUMBER,SUBSCRIBER_DOA,HOME_PHONE_NUMBER,OFFICE_PHONE_NUMBER,CONTACT_PHONE_NUMBER,MCN1,MCN2,IMSI,IMEI,
	CONNECTION_TYPE,GROUPS,SERVICES,STATUS,QOS,PRODUCT_TYPE,MODIFIED_DATE,NETWORK_ID,RATEPLAN,RATEPLAN_ID,DATE_OF_BIRTH,BILLCYCLE,
	SUBSCRIPTION_TYPE,CREDIT_CLASS,END_SERVICE_DATE,NATIONALITY,PASSPORT_NUMBER,COMPANY_REGISTRATION_NUMBER,GROUP_DESCRIPTION,
	OPTIONAL_FIELD1,OPTIONAL_FIELD2,OPTIONAL_FIELD3,OPTIONAL_FIELD4,OPTIONAL_FIELD5,OPTIONAL_FIELD6,OPTIONAL_FIELD7,OPTIONAL_FIELD8,
	OPTIONAL_FIELD9,OPTIONAL_FIELD10,MAIN_DIR_NO_FLAG,SUBSCRIBER_TYPE,ACCOUNT_NAME
)
SELECT
	ID,ACCOUNT_ID,PHONE_NUMBER,SUBSCRIBER_DOA,HOME_PHONE_NUMBER,OFFICE_PHONE_NUMBER,CONTACT_PHONE_NUMBER,MCN1,MCN2,IMSI,IMEI,
	CONNECTION_TYPE,GROUPS,SERVICES,STATUS,QOS,PRODUCT_TYPE,MODIFIED_DATE,NETWORK_ID,RATEPLAN,RATEPLAN_ID,DATE_OF_BIRTH,BILLCYCLE,
	SUBSCRIPTION_TYPE,CREDIT_CLASS,END_SERVICE_DATE,NATIONALITY,PASSPORT_NUMBER,COMPANY_REGISTRATION_NUMBER,GROUP_DESCRIPTION,
	OPTIONAL_FIELD1,OPTIONAL_FIELD2,OPTIONAL_FIELD3,OPTIONAL_FIELD4,OPTIONAL_FIELD5,OPTIONAL_FIELD6,OPTIONAL_FIELD7,OPTIONAL_FIELD8,
	OPTIONAL_FIELD9,OPTIONAL_FIELD10,MAIN_DIR_NO_FLAG,0,'Active Account'
FROM MIGRATE.SUBSCRIBER;

insert into SUBSCRIBER 
(
	ID,ACCOUNT_ID,PHONE_NUMBER,SUBSCRIBER_DOA,HOME_PHONE_NUMBER,OFFICE_PHONE_NUMBER,CONTACT_PHONE_NUMBER,MCN1,MCN2,IMSI,IMEI,
	CONNECTION_TYPE,GROUPS,SERVICES,STATUS,QOS,PRODUCT_TYPE,MODIFIED_DATE,NETWORK_ID,RATEPLAN,RATEPLAN_ID,DATE_OF_BIRTH,BILLCYCLE,
	SUBSCRIPTION_TYPE,CREDIT_CLASS,END_SERVICE_DATE,NATIONALITY,PASSPORT_NUMBER,COMPANY_REGISTRATION_NUMBER,GROUP_DESCRIPTION,
	OPTIONAL_FIELD1,OPTIONAL_FIELD2,OPTIONAL_FIELD3,OPTIONAL_FIELD4,OPTIONAL_FIELD5,OPTIONAL_FIELD6,OPTIONAL_FIELD7,OPTIONAL_FIELD8,
	OPTIONAL_FIELD9,OPTIONAL_FIELD10,MAIN_DIR_NO_FLAG,SUBSCRIBER_TYPE,ACCOUNT_NAME
)
SELECT
	ID,ACCOUNT_ID,PHONE_NUMBER,SUBSCRIBER_DOA,HOME_PHONE_NUMBER,OFFICE_PHONE_NUMBER,CONTACT_PHONE_NUMBER,MCN1,MCN2,IMSI,IMEI,
	CONNECTION_TYPE,GROUPS,SERVICES,STATUS,QOS,PRODUCT_TYPE,MODIFIED_DATE,NETWORK_ID,RATEPLAN,RATEPLAN_ID,DATE_OF_BIRTH,BILLCYCLE,
	SUBSCRIPTION_TYPE,CREDIT_CLASS,END_SERVICE_DATE,NATIONALITY,PASSPORT_NUMBER,COMPANY_REGISTRATION_NUMBER,GROUP_DESCRIPTION,
	OPTIONAL_FIELD1,OPTIONAL_FIELD2,OPTIONAL_FIELD3,OPTIONAL_FIELD4,OPTIONAL_FIELD5,OPTIONAL_FIELD6,OPTIONAL_FIELD7,OPTIONAL_FIELD8,
	OPTIONAL_FIELD9,OPTIONAL_FIELD10,MAIN_DIR_NO_FLAG,1,'Black-Listed Account'
FROM MIGRATE.BLACKLIST_SUBSCRIBER;

insert into RATER_SPECIAL_NUMBERS SELECT RATER_SPECIAL_NUMBERS_SEQ.nextval, A.* FROM MIGRATE.RATER_SPECIAL_NUMBER A;
---
delete from ZONE_CODES ;
insert into ZONE_CODES (ID, ZONE_CODE) SELECT ZONE_CODES_SEQ.nextval, A.ZONE_CODE FROM
(
	SELECT ZONE_CODE FROM MIGRATE.ORG_DEST_LINK WHERE ZONE_CODE IS NOT NULL
	UNION
	SELECT ZONE_CODE FROM MIGRATE.RATE_PLAN WHERE ZONE_CODE IS NOT NULL
) A ;
---
insert into ORG_DEST_LINKS(ID,ORG_GEO_CODE,DEST_GEO_CODE,ZONE_CODE,NATIONAL_FLAG,LETTER_CODE)
	SELECT ORG_DEST_LINKS_SEQ.nextval, A.ORG_GEO_CODE,A.DEST_GEO_CODE,A.ZONE_CODE,A.NATIONAL_FLAG,A.LETTER_CODE
	FROM MIGRATE.ORG_DEST_LINK A;
insert into RATE_PER_CALLS
(
	ID,SERVICE_NUMBER,DESCRIPTION,CALL_TYPE,SERVICE_CATEGORY,SERVICE_PROVIDER,
	SERVICE_BAND,AIR_AMOUNT_PER_CALL,PSTN_AMOUNT_PER_CALL,EXTRA_CHARGE
)
	SELECT RATE_PER_CALLS_SEQ.nextval, SERVICE_NUMBER,DESCRIPTION,CALL_TYPE,SERVICE_CATEGORY,SERVICE_PROVIDER,
		SERVICE_BAND, AIR_AMOUNT_PER_CALL,PSTN_AMOUNT_PER_CALL,EXTRA_CHARGE
	FROM MIGRATE.RATE_PER_CALL A;
---
delete from RATE_TYPES ;
insert into RATE_TYPES (ID, RATE_TYPE) SELECT RATE_TYPES_SEQ.nextval, A.RATE_TYPE FROM
(
	SELECT RATE_TYPE FROM MIGRATE.TIME_ZONE_RATE_TYPE WHERE RATE_TYPE IS NOT NULL
	UNION
	SELECT RATE_TYPE FROM MIGRATE.RATE_PLAN WHERE RATE_TYPE IS NOT NULL
) A ;
---
insert into TIME_ZONE_RATE_TYPES(ID,DAY_TYPE,START_TIME,END_TIME,SERVICE_CATEGORY,NATIONAL_FLAG,RATE_TYPE)
	SELECT TIME_ZONE_RATE_TYPES_SEQ.nextval, A.DAY_TYPE,A.START_TIME,A.END_TIME,A.SERVICE_CATEGORY,A.NATIONAL_FLAG,A.RATE_TYPE
	FROM MIGRATE.TIME_ZONE_RATE_TYPE A;
insert into RATE_PLANS
(
	ID,RATE_PLAN,ROAMER_FLAG,RATE_PLAN_ID,ORG_NUMBER_TYPE,DEST_NUMBER_TYPE,ZONE_CODE,RATE_TYPE,CALL_TYPE,SERVICE_BAND,
	MIN_CHARGEABLE_UNIT,MIN_CHARGE,PULSE,RATE,PSTN_MIN_CHARGEABLE_UNIT,PSTN_MIN_CHARGE,PSTN_PULSE,PSTN_RATE, FF_MIN_CHARGEABLE_UNIT,
	FF_MIN_CHARGE,FF_PULSE,FF_RATE,FF_PSTN_MIN_CHARGEABLE_UNIT,FF_PSTN_MIN_CHARGE,FF_PSTN_PULSE,FF_PSTN_RATE,EXTRA_CHARGE
)
	SELECT RATE_PLANS_SEQ.nextval, RATE_PLAN,ROAMER_FLAG,RATE_PLAN_ID,ORG_NUMBER_TYPE,DEST_NUMBER_TYPE,ZONE_CODE,RATE_TYPE,CALL_TYPE,
		SERVICE_BAND, MIN_CHARGEABLE_UNIT,MIN_CHARGE,PULSE,RATE,PSTN_MIN_CHARGEABLE_UNIT,PSTN_MIN_CHARGE,PSTN_PULSE,PSTN_RATE,
		FF_MIN_CHARGEABLE_UNIT, FF_MIN_CHARGE,FF_PULSE,FF_RATE,FF_PSTN_MIN_CHARGEABLE_UNIT,FF_PSTN_MIN_CHARGE,FF_PSTN_PULSE,
		FF_PSTN_RATE,EXTRA_CHARGE
	FROM MIGRATE.RATE_PLAN ;
insert into WEEKENDS(ID,WEEKEND,DESCRIPTION)
	SELECT WEEKENDS_SEQ.nextval, A.WEEKEND, A.DESCRIPTION FROM MIGRATE.WEEKEND A;
insert into DEFAULT_RATES(ID,RATE_TYPE,CALL_TYPE,PULSE,RATE)
	SELECT DEFAULT_RATES_SEQ.nextval, A.RATE_TYPE, A.CALL_TYPE, A.PULSE, A.RATE FROM MIGRATE.DEFAULT_RATE A;
insert into RCF_INFOS SELECT RCF_INFOS_SEQ.nextval, A.* FROM MIGRATE.RCF_INFO A;

insert into FREE_NUMBERS(ID, FREE_NUMBER, DESCRIPTION)
	SELECT FREE_NUMBERS_SEQ.nextval, A.FREE_NUMBER, A.DESCRIPTION FROM MIGRATE.FREE_NUMBER A;
insert into FREE_NUMBERS_NETWORKS(FREE_NUMBER_ID, NETWORK_ID) SELECT ID, 999 FROM FREE_NUMBERS ;

insert into HOLIDAY_LISTS(ID, HOLIDAY_DATE, DESCRIPTION)
	SELECT HOLIDAY_LISTS_SEQ.nextval, A.HOLIDAY_DATE, A.DESCRIPTION FROM MIGRATE.HOLIDAY_LIST A;
insert into HOLIDAY_LISTS_NETWORKS(HOLIDAY_LIST_ID, NETWORK_ID) SELECT ID, 999 FROM HOLIDAY_LISTS ;

insert into SDR_RATES(ID, START_DATE, END_DATE, SDR_VALUE)
	SELECT SDR_RATES_SEQ.nextval, A.START_DATE, A.END_DATE, A.SDR_VALUE FROM MIGRATE.SDR_RATE A;
insert into NETWORKS_SDR_RATES(SDR_RATE_ID, NETWORK_ID) SELECT ID, 999 FROM SDR_RATES ;

-- update it further to delete only DU spec confs
delete from CONFIGURATIONS WHERE lower(CONFIG_KEY) IN (SELECT lower(ID) FROM MIGRATE.CONFIGURATION) ;
insert into CONFIGURATIONS(ID, CONFIG_KEY, VALUE, IS_VISIBLE)
	SELECT CONFIGURATIONS_SEQ.nextval, A.ID, A.VALUE, 1 FROM MIGRATE.CONFIGURATION A ;
update CONFIGURATIONS set VALUE = replace(VALUE, '/ranger/RangerRoot', '/home/raghut/Ranger5.4Root') where VALUE like '%RangerRoot%' ;
--delete from CONFIGURATIONS WHERE CONFIG_KEY IN
--(
--	SELECT C.CONFIG_KEY FROM CONFIGURATIONS C, MIGRATE.CONFIGURATION C1 
--	WHERE C.CONFIG_KEY= C1.ID AND C.VALUE != C1.VALUE AND C1.VALUE NOT LIKE '%RangerRoot%'
--) ;
--
--insert into CONFIGURATIONS(ID, CONFIG_KEY, VALUE, IS_VISIBLE)
--	SELECT CONFIGURATIONS_SEQ.nextval, C1.ID, C1.VALUE, 1 FROM CONFIGURATIONS C, MIGRATE.CONFIGURATION C1 
--	WHERE C.CONFIG_KEY= C1.ID AND C.VALUE != C1.VALUE AND C1.VALUE NOT LIKE '%RangerRoot%' ;
--
--insert into CONFIGURATIONS(ID, CONFIG_KEY, VALUE, IS_VISIBLE)
--	SELECT CONFIGURATIONS_SEQ.nextval, C1.ID, C1.VALUE, 1 FROM CONFIGURATIONS C, MIGRATE.CONFIGURATION C1 
--	WHERE C.CONFIG_KEY != C1.ID AND C.VALUE != C1.VALUE AND C1.VALUE NOT LIKE '%RangerRoot%' ;
----

--delete from Network;
--delete from blacklist_subscriber;

commit;
exit;
