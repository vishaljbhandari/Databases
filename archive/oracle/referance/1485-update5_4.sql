delete from DU_SGSN_ADDRESSES ;
delete from ROAMER_PARTNER ;
delete from RATER_SPECIAL_NUMBER ;
delete from CELL_SITE_GEO_POSITION ;
delete from LOCAL_NUMBER ;
delete from DU_SERVICE_ID_DESCRIPTION ;
delete from SDR_RATE ;
delete from DU_RECORD_TYPE ;
delete from SUBSCRIBER_GROUP_MAP ;
delete from EM_COLOUR_SUBSCRIBER_MAP ;
delete from SUBSCRIBER ;
delete from DU_RECHARGE_RATE_TYPES ;
delete from DU_RECHARGE_TYPES ;
delete from DU_OPC_DPC ;
delete from PREPAID_SUBSCRIBER ;
delete from CLI_SUBSCRIBER_NUMBER_MAP ;
--delete from du_nrtrde_rate ;
delete from FREE_NUMBER ;
delete from ORG_DEST_LINK ;
delete from RATE_PER_CALL ;
delete from TIME_ZONE_RATE_TYPE ;
delete from RATE_PLAN ;
delete from HOLIDAY_LIST ;
delete from WEEKEND ;
delete from DEFAULT_RATE ;
delete from RCF_INFO ;
delete from CONFIGURATION ;
delete from rating_configuration ;
delete from DU_SPECIAL_NUMBERS ;
delete from zonecode_countrycode_map ;
delete from du_mobile_content_services ;
--delete from Network ;
delete from gsm_prefix ;
delete from duplicate_cdr_file_config ;
delete from cdr_file_detail ;
delete from blacklist_subscriber ;
delete from DS_ASCII_INPUT_CONFIGURATION ;

insert into DU_SGSN_ADDRESSES select * from migrate.DU_SGSN_ADDRESSES;
---
alter table ROAMER_PARTNER drop constraint PK_RM_PR_NW;
---
insert into ROAMER_PARTNER select * from migrate.ROAMER_PARTNER;
insert into RATER_SPECIAL_NUMBER select * from migrate.RATER_SPECIAL_NUMBER;
insert into CELL_SITE_GEO_POSITION select * from migrate.CELL_SITE_GEO_POSITION;
insert into LOCAL_NUMBER select * from migrate.LOCAL_NUMBER;
insert into DU_SERVICE_ID_DESCRIPTION select * from migrate.DU_SERVICE_ID_DESCRIPTION;
insert into SDR_RATE select * from migrate.SDR_RATE;
insert into DU_RECORD_TYPE select * from migrate.DU_RECORD_TYPE;

alter table SUBSCRIBER drop constraint FK_SUBSCRIBER_ACC_ID;
insert into SUBSCRIBER 
(
	id, ACCOUNT_ID,PHONE_NUMBER,SUBSCRIBER_DOA,HOME_PHONE_NUMBER,OFFICE_PHONE_NUMBER,CONTACT_PHONE_NUMBER,MCN1,MCN2,IMSI,IMEI,
	CONNECTION_TYPE,GROUPS,SERVICES,STATUS,QOS,PRODUCT_TYPE,MODIFIED_DATE,NETWORK_ID,RATEPLAN,RATEPLAN_ID,DATE_OF_BIRTH,BILLCYCLE,
	SUBSCRIPTION_TYPE,CREDIT_CLASS,END_SERVICE_DATE,NATIONALITY,PASSPORT_NUMBER,COMPANY_REGISTRATION_NUMBER,GROUP_DESCRIPTION,
	OPTIONAL_FIELD1,OPTIONAL_FIELD2,OPTIONAL_FIELD3,OPTIONAL_FIELD4,OPTIONAL_FIELD5,OPTIONAL_FIELD6,OPTIONAL_FIELD7,OPTIONAL_FIELD8,
	OPTIONAL_FIELD9,OPTIONAL_FIELD10,MAIN_DIR_NO_FLAG
)
SELECT
	id, ACCOUNT_ID,PHONE_NUMBER,SUBSCRIBER_DOA,HOME_PHONE_NUMBER,OFFICE_PHONE_NUMBER,CONTACT_PHONE_NUMBER,MCN1,MCN2,IMSI,IMEI,
	CONNECTION_TYPE,GROUPS,SERVICES,STATUS,QOS,PRODUCT_TYPE,MODIFIED_DATE,NETWORK_ID,RATEPLAN,RATEPLAN_ID,DATE_OF_BIRTH,BILLCYCLE,
	SUBSCRIPTION_TYPE,CREDIT_CLASS,END_SERVICE_DATE,NATIONALITY,PASSPORT_NUMBER,COMPANY_REGISTRATION_NUMBER,GROUP_DESCRIPTION,
	OPTIONAL_FIELD1,OPTIONAL_FIELD2,OPTIONAL_FIELD3,OPTIONAL_FIELD4,OPTIONAL_FIELD5,OPTIONAL_FIELD6,OPTIONAL_FIELD7,OPTIONAL_FIELD8,
	OPTIONAL_FIELD9,OPTIONAL_FIELD10,MAIN_DIR_NO_FLAG
FROM MIGRATE.SUBSCRIBER;

insert into DU_RECHARGE_RATE_TYPES select * from migrate.DU_RECHARGE_RATE_TYPES;
insert into DU_RECHARGE_TYPES select * from migrate.DU_RECHARGE_TYPES;
insert into DU_OPC_DPC select * from migrate.DU_OPC_DPC;
insert into PREPAID_SUBSCRIBER select * from migrate.PREPAID_SUBSCRIBER;
insert into CLI_SUBSCRIBER_NUMBER_MAP select * from migrate.CLI_SUBSCRIBER_NUMBER_MAP;
--insert into du_nrtrde_rate select * from migrate.du_nrtrde_rate;
insert into FREE_NUMBER select * from migrate.FREE_NUMBER;
---
delete from ZONE_CODE ;
insert into ZONE_CODE (ZONE_CODE) SELECT A.ZONE_CODE FROM
(
	SELECT ZONE_CODE FROM MIGRATE.ORG_DEST_LINK WHERE ZONE_CODE IS NOT NULL
	UNION
	SELECT ZONE_CODE FROM MIGRATE.RATE_PLAN WHERE ZONE_CODE IS NOT NULL
) A ;
---
insert into ORG_DEST_LINK SELECT * FROM MIGRATE.ORG_DEST_LINK;
insert into RATE_PER_CALL SELECT * FROM MIGRATE.RATE_PER_CALL;
---
delete from RATE_TYPE ;
insert into RATE_TYPE (RATE_TYPE) SELECT A.RATE_TYPE FROM
(
	SELECT RATE_TYPE FROM MIGRATE.TIME_ZONE_RATE_TYPE WHERE RATE_TYPE IS NOT NULL
	UNION
	SELECT RATE_TYPE FROM MIGRATE.RATE_PLAN WHERE RATE_TYPE IS NOT NULL
) A ;
---
insert into TIME_ZONE_RATE_TYPE SELECT * FROM MIGRATE.TIME_ZONE_RATE_TYPE;
insert into RATE_PLAN SELECT * FROM MIGRATE.RATE_PLAN ;
insert into ORG_DEST_LINK select * from migrate.ORG_DEST_LINK;
insert into RATE_PER_CALL select * from migrate.RATE_PER_CALL;
insert into TIME_ZONE_RATE_TYPE select * from migrate.TIME_ZONE_RATE_TYPE;
insert into RATE_PLAN select * from migrate.RATE_PLAN;
insert into HOLIDAY_LIST select * from migrate.HOLIDAY_LIST;
insert into WEEKEND select * from migrate.WEEKEND;
insert into DEFAULT_RATE select * from migrate.DEFAULT_RATE;
insert into RCF_INFO select * from migrate.RCF_INFO;

insert into CONFIGURATION select * from migrate.CONFIGURATION;
update CONFIGURATION set VALUE = replace(VALUE, '/ranger/RangerRoot', '/home/raghut/Ranger5.4Root') where VALUE like '%RangerRoot%' ;

insert into rating_configuration select * from migrate.rating_configuration;
insert into DU_SPECIAL_NUMBERS select * from migrate.DU_SPECIAL_NUMBERS;
insert into zonecode_countrycode_map select * from migrate.zonecode_countrycode_map;
insert into du_mobile_content_services select * from migrate.du_mobile_content_services;
insert into gsm_prefix select * from migrate.gsm_prefix;
insert into duplicate_cdr_file_config select * from migrate.duplicate_cdr_file_config;
insert into cdr_file_detail SELECT * FROM MIGRATE.cdr_file_detail A
	WHERE A.DS_TYPE IS NOT NULL AND A.FILE_NAME IS NOT NULL AND A.TIME_STAMP IS NOT NULL AND A.FILE_SIZE IS NOT NULL ;

alter table BLACKLIST_SUBSCRIBER drop constraint FK_BL_SUBSCRIBER_ACC_ID;
insert into BLACKLIST_SUBSCRIBER 
(
	ID,ACCOUNT_ID,PHONE_NUMBER,SUBSCRIBER_DOA,HOME_PHONE_NUMBER,OFFICE_PHONE_NUMBER,CONTACT_PHONE_NUMBER,MCN1,MCN2,IMSI,IMEI,
	CONNECTION_TYPE,GROUPS,SERVICES,STATUS,QOS,PRODUCT_TYPE,MODIFIED_DATE,NETWORK_ID,RATEPLAN,RATEPLAN_ID,DATE_OF_BIRTH,BILLCYCLE,
	SUBSCRIPTION_TYPE,CREDIT_CLASS,END_SERVICE_DATE,NATIONALITY,PASSPORT_NUMBER,COMPANY_REGISTRATION_NUMBER,GROUP_DESCRIPTION,
	OPTIONAL_FIELD1,OPTIONAL_FIELD2,OPTIONAL_FIELD3,OPTIONAL_FIELD4,OPTIONAL_FIELD5,OPTIONAL_FIELD6,OPTIONAL_FIELD7,OPTIONAL_FIELD8,
	OPTIONAL_FIELD9,OPTIONAL_FIELD10,MAIN_DIR_NO_FLAG
)
SELECT
	ID,ACCOUNT_ID,PHONE_NUMBER,SUBSCRIBER_DOA,HOME_PHONE_NUMBER,OFFICE_PHONE_NUMBER,CONTACT_PHONE_NUMBER,MCN1,MCN2,IMSI,IMEI,
	CONNECTION_TYPE,GROUPS,SERVICES,STATUS,QOS,PRODUCT_TYPE,MODIFIED_DATE,NETWORK_ID,RATEPLAN,RATEPLAN_ID,DATE_OF_BIRTH,BILLCYCLE,
	SUBSCRIPTION_TYPE,CREDIT_CLASS,END_SERVICE_DATE,NATIONALITY,PASSPORT_NUMBER,COMPANY_REGISTRATION_NUMBER,GROUP_DESCRIPTION,
	OPTIONAL_FIELD1,OPTIONAL_FIELD2,OPTIONAL_FIELD3,OPTIONAL_FIELD4,OPTIONAL_FIELD5,OPTIONAL_FIELD6,OPTIONAL_FIELD7,OPTIONAL_FIELD8,
	OPTIONAL_FIELD9,OPTIONAL_FIELD10,MAIN_DIR_NO_FLAG
FROM MIGRATE.BLACKLIST_SUBSCRIBER;

insert into DS_ASCII_INPUT_CONFIGURATION select * from migrate.DS_ASCII_INPUT_CONFIGURATION;
commit;
exit;
