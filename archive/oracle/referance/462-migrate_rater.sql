DELETE FROM SPECIAL_NUMBER ;
DELETE FROM PARTIAL_CDR_INFO ;
DELETE FROM DS_ASCII_INPUT_CONFIGURATION ;

--DELETE FROM CDR_FILE_DETAIL ;

DELETE FROM DUPLICATE_CDR_FILE_CONFIG ;
DELETE FROM GSM_PREFIX ;
DELETE FROM DU_MOBILE_CONTENT_SERVICES ;
DELETE FROM DU_SERVICE_ID_DESCRIPTION ;
DELETE FROM ZONECODE_COUNTRYCODE_MAP ;
DELETE FROM COUNTRY_CODES ;
DELETE FROM DU_SPECIAL_NUMBERS ;
DELETE FROM RATING_CONFIGURATION ;
DELETE FROM RCF_INFOS ;
DELETE FROM DEFAULT_RATES ;
DELETE FROM WEEKENDS ;
DELETE FROM HOLIDAY_LISTS_NETWORKS ;
DELETE FROM HOLIDAY_LISTS ;
DELETE FROM RATE_PLANS ;
DELETE FROM TIME_ZONE_RATE_TYPES ;
DELETE FROM RATE_TYPES ;
DELETE FROM RATE_PER_CALLS ;
DELETE FROM ORG_DEST_LINKS ;
DELETE FROM ZONE_CODES ;
DELETE FROM FREE_NUMBERS_NETWORKS ;
DELETE FROM FREE_NUMBERS ;
DELETE FROM DU_NRTRDE_RATE ;
DELETE FROM CLI_SUBSCRIBER_NUMBER_MAP ;
DELETE FROM PREPAID_SUBSCRIBER ;
DELETE FROM DU_OPC_DPC ;
DELETE FROM DU_RECHARGE_TYPES ;
DELETE FROM DU_RECHARGE_RATE_TYPES ;
DELETE FROM DU_RECORD_TYPE ;
DELETE FROM NETWORKS_SDR_RATES ;
DELETE FROM SDR_RATES ;
DELETE FROM LOCAL_NUMBER ;
DELETE FROM CELL_SITE_GEO_POSITIONS ;
DELETE FROM NETWORKS_RATER_SPECIAL_NUMBERS ;
DELETE FROM RATER_SPECIAL_NUMBERS ;
DELETE FROM ROAMER_PARTNER ;
DELETE FROM DU_SGSN_ADDRESSES ;

INSERT INTO DU_SGSN_ADDRESSES SELECT * FROM DU_SGSN_ADDRESSES@DU_NIKIRA ;
INSERT INTO ROAMER_PARTNER SELECT * FROM ROAMER_PARTNER@DU_NIKIRA ;

INSERT INTO RATER_SPECIAL_NUMBERS
(
	ID, DESCRIPTION, SPECIAL_NUMBER, SERVICE_CATEGORY, MIN_CHARGEABLE_UNIT, MIN_CHARGE, PULSE, RATE,
	PSTN_MIN_CHARGEABLE_UNIT, PSTN_MIN_CHARGE, PSTN_PULSE, PSTN_RATE, EXTRA_CHARGE, CALL_TYPE
)
SELECT
	RATER_SPECIAL_NUMBERS_SEQ.nextval, DESCRIPTION, SPECIAL_NUMBER, SERVICE_CATEGORY, MIN_CHARGEABLE_UNIT, MIN_CHARGE,
	PULSE, RATE, PSTN_MIN_CHARGEABLE_UNIT, PSTN_MIN_CHARGE, PSTN_PULSE, PSTN_RATE, EXTRA_CHARGE, CALL_TYPE
FROM RATER_SPECIAL_NUMBER@DU_NIKIRA ;
INSERT INTO NETWORKS_RATER_SPECIAL_NUMBERS (RATER_SPECIAL_NUMBER_ID, NETWORK_ID) SELECT ID, 999 FROM RATER_SPECIAL_NUMBERS ;

INSERT INTO CELL_SITE_GEO_POSITIONS (ID, CELL_SITE_ID, LONGITUDE, LATITUDE, CELL_LOCATION, RADIUS_COVERAGE, NETWORK_ID, TIME_ZONE)
	SELECT CELL_SITE_GEO_POSITIONS_SEQ.nextval, CELL_SITE_ID, LONGITUDE, LATITUDE, CELL_LOCATION, RADIUS_COVERAGE, NETWORK_ID, TIME_ZONE
	FROM CELL_SITE_GEO_POSITION@DU_NIKIRA ;

INSERT INTO LOCAL_NUMBER SELECT * FROM LOCAL_NUMBER@DU_NIKIRA ;

INSERT INTO SDR_RATES (ID, START_DATE, END_DATE, SDR_VALUE)
	SELECT SDR_RATES_SEQ.nextval, START_DATE, END_DATE, SDR_VALUE FROM SDR_RATE@DU_NIKIRA ;
INSERT INTO NETWORKS_SDR_RATES (SDR_RATE_ID, NETWORK_ID) SELECT ID, 999 FROM SDR_RATES ;

INSERT INTO DU_RECORD_TYPE SELECT * FROM DU_RECORD_TYPE@DU_NIKIRA ;
INSERT INTO DU_RECHARGE_RATE_TYPES SELECT * FROM DU_RECHARGE_RATE_TYPES@DU_NIKIRA ;
INSERT INTO DU_RECHARGE_TYPES SELECT * FROM DU_RECHARGE_TYPES@DU_NIKIRA ;
INSERT INTO DU_OPC_DPC SELECT * FROM DU_OPC_DPC@DU_NIKIRA ;
INSERT INTO PREPAID_SUBSCRIBER SELECT * FROM PREPAID_SUBSCRIBER@DU_NIKIRA ;
INSERT INTO CLI_SUBSCRIBER_NUMBER_MAP SELECT * FROM CLI_SUBSCRIBER_NUMBER_MAP@DU_NIKIRA ;
INSERT INTO DU_NRTRDE_RATE SELECT * FROM DU_NRTRDE_RATE@DU_NIKIRA ;

INSERT INTO FREE_NUMBERS (ID, FREE_NUMBER, DESCRIPTION)
	SELECT FREE_NUMBERS_SEQ.nextval, FREE_NUMBER, DESCRIPTION FROM FREE_NUMBER@DU_NIKIRA ;
INSERT INTO FREE_NUMBERS_NETWORKS (FREE_NUMBER_ID, NETWORK_ID) SELECT ID, 999 FROM FREE_NUMBERS ;

INSERT INTO ZONE_CODES (ID, ZONE_CODE, DESCRIPTION)
	SELECT ZONE_CODES_SEQ.nextval, ZONE_CODE, DESCRIPTION FROM ZONE_CODE@DU_NIKIRA ;

INSERT INTO ORG_DEST_LINKS (ID, ORG_GEO_CODE, DEST_GEO_CODE, ZONE_CODE, NATIONAL_FLAG, LETTER_CODE)
	SELECT ORG_DEST_LINKS_SEQ.nextval, ORG_GEO_CODE, DEST_GEO_CODE, ZONE_CODE, NATIONAL_FLAG, LETTER_CODE
	FROM ORG_DEST_LINK@DU_NIKIRA ;

INSERT INTO RATE_PER_CALLS
(
	ID,SERVICE_NUMBER,DESCRIPTION,CALL_TYPE,SERVICE_CATEGORY,SERVICE_PROVIDER,
	SERVICE_BAND,AIR_AMOUNT_PER_CALL,PSTN_AMOUNT_PER_CALL,EXTRA_CHARGE
)
SELECT
	RATE_PER_CALLS_SEQ.nextval, SERVICE_NUMBER, DESCRIPTION, CALL_TYPE, SERVICE_CATEGORY,
	SERVICE_PROVIDER, SERVICE_BAND, AIR_AMOUNT_PER_CALL, PSTN_AMOUNT_PER_CALL, EXTRA_CHARGE
FROM RATE_PER_CALL@DU_NIKIRA ;

INSERT INTO RATE_TYPES (ID, RATE_TYPE, DESCRIPTION)
	SELECT RATE_TYPES_SEQ.nextval, RATE_TYPE, DESCRIPTION FROM RATE_TYPE@DU_NIKIRA ;

INSERT INTO TIME_ZONE_RATE_TYPES(ID, DAY_TYPE, START_TIME, END_TIME, SERVICE_CATEGORY, NATIONAL_FLAG, RATE_TYPE)
	SELECT TIME_ZONE_RATE_TYPES_SEQ.nextval, DAY_TYPE, START_TIME, END_TIME, SERVICE_CATEGORY, NATIONAL_FLAG, RATE_TYPE
	FROM TIME_ZONE_RATE_TYPE@DU_NIKIRA ;

INSERT INTO RATE_PLANS
(
	ID, RATE_PLAN, ROAMER_FLAG, RATE_PLAN_ID, ORG_NUMBER_TYPE, DEST_NUMBER_TYPE, ZONE_CODE, RATE_TYPE,
	CALL_TYPE, SERVICE_BAND, MIN_CHARGEABLE_UNIT, MIN_CHARGE, PULSE, RATE, PSTN_MIN_CHARGEABLE_UNIT,
	PSTN_MIN_CHARGE, PSTN_PULSE, PSTN_RATE, FF_MIN_CHARGEABLE_UNIT, FF_MIN_CHARGE, FF_PULSE, FF_RATE,
	FF_PSTN_MIN_CHARGEABLE_UNIT, FF_PSTN_MIN_CHARGE, FF_PSTN_PULSE, FF_PSTN_RATE, EXTRA_CHARGE
)
SELECT
	RATE_PLANS_SEQ.nextval, RATE_PLAN, ROAMER_FLAG, RATE_PLAN_ID, ORG_NUMBER_TYPE, DEST_NUMBER_TYPE, ZONE_CODE,
	RATE_TYPE, CALL_TYPE, SERVICE_BAND, MIN_CHARGEABLE_UNIT, MIN_CHARGE, PULSE, RATE, PSTN_MIN_CHARGEABLE_UNIT,
	PSTN_MIN_CHARGE, PSTN_PULSE, PSTN_RATE, FF_MIN_CHARGEABLE_UNIT, FF_MIN_CHARGE, FF_PULSE, FF_RATE,
	FF_PSTN_MIN_CHARGEABLE_UNIT, FF_PSTN_MIN_CHARGE, FF_PSTN_PULSE, FF_PSTN_RATE, EXTRA_CHARGE
FROM RATE_PLAN@DU_NIKIRA ;

INSERT INTO HOLIDAY_LISTS(ID, HOLIDAY_DATE, DESCRIPTION)
	SELECT HOLIDAY_LISTS_SEQ.nextval, HOLIDAY_DATE, DESCRIPTION FROM HOLIDAY_LIST@DU_NIKIRA ;
INSERT INTO HOLIDAY_LISTS_NETWORKS(HOLIDAY_LIST_ID, NETWORK_ID) SELECT ID, 999 FROM HOLIDAY_LISTS ;

INSERT INTO WEEKENDS(ID, WEEKEND, DESCRIPTION)
	SELECT WEEKENDS_SEQ.nextval, WEEKEND, DESCRIPTION FROM WEEKEND@DU_NIKIRA ;

INSERT INTO DEFAULT_RATES(ID, RATE_TYPE, CALL_TYPE, PULSE, RATE)
	SELECT DEFAULT_RATES_SEQ.nextval, RATE_TYPE, CALL_TYPE, PULSE, RATE FROM DEFAULT_RATE@DU_NIKIRA ;

INSERT INTO RCF_INFOS (ID, LETTER_CODE, VPLMN_ID, IMSI_CODE, PLMN_NAME)
	SELECT RCF_INFOS_SEQ.nextval, LETTER_CODE, VPLMN_ID, IMSI_CODE, PLMN_NAME FROM RCF_INFO@DU_NIKIRA ;

INSERT INTO RATING_CONFIGURATION SELECT * FROM RATING_CONFIGURATION@DU_NIKIRA ;
INSERT INTO DU_SPECIAL_NUMBERS SELECT * FROM DU_SPECIAL_NUMBERS@DU_NIKIRA ;
INSERT INTO COUNTRY_CODES(CODE, DESCRIPTION) SELECT CODE, DESCRIPTION FROM COUNTRY_CODE@DU_NIKIRA ;
INSERT INTO ZONECODE_COUNTRYCODE_MAP SELECT * FROM ZONECODE_COUNTRYCODE_MAP@DU_NIKIRA ;
INSERT INTO DU_SERVICE_ID_DESCRIPTION SELECT * FROM DU_SERVICE_ID_DESCRIPTION@DU_NIKIRA ;
INSERT INTO DU_MOBILE_CONTENT_SERVICES SELECT * FROM DU_MOBILE_CONTENT_SERVICES@DU_NIKIRA ;
INSERT INTO GSM_PREFIX SELECT * FROM GSM_PREFIX@DU_NIKIRA ;

INSERT INTO DUPLICATE_CDR_FILE_CONFIG SELECT * FROM DUPLICATE_CDR_FILE_CONFIG@DU_NIKIRA ;

DECLARE
	CNT NUMBER;
BEGIN
	SELECT COUNT(*) INTO CNT FROM DUPLICATE_CDR_FILE_CONFIG WHERE DS_TYPE='UNKNOWN';
	IF CNT = 0
	THEN
		INSERT INTO DUPLICATE_CDR_FILE_CONFIG(DS_TYPE, TIME_BAND) VALUES('UNKNOWN', 1);
	END IF;
END;
/

--INSERT INTO SELECT * FROM CDR_FILE_DETAIL ;
--INSERT INTO CDR_FILE_DETAIL SELECT * FROM CDR_FILE_DETAIL
--	WHERE DS_TYPE IS NOT NULL AND FILE_NAME IS NOT NULL AND TIME_STAMP IS NOT NULL AND FILE_SIZE IS NOT NULL ;

INSERT INTO DS_ASCII_INPUT_CONFIGURATION SELECT * FROM DS_ASCII_INPUT_CONFIGURATION@DU_NIKIRA ;
INSERT INTO PARTIAL_CDR_INFO SELECT * FROM PARTIAL_CDR_INFO@DU_NIKIRA ;
INSERT INTO SPECIAL_NUMBER SELECT * FROM SPECIAL_NUMBER@DU_NIKIRA ;

COMMIT ;
EXIT ;
