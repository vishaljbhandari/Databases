spool nikira-DDL-db-demo-mlh.log
set feedback off ;
set serveroutput off ;

CREATE INDEX IX_ACC_HIERARCHY_ID ON ACCOUNT("HIERARCHY_ID");
CREATE OR REPLACE VIEW SUBSCRIBER_MLH
AS
SELECT S.*,A.PARENT_ID,A.HIERARCHY_ID
FROM SUBSCRIBER S,ACCOUNT A
WHERE A.ID = S.ACCOUNT_ID
AND ((S.SUBSCRIBER_TYPE in (0,1) AND A.ACCOUNT_TYPE in (0,1)) OR (S.SUBSCRIBER_TYPE = A.ACCOUNT_TYPE AND  A.ACCOUNT_TYPE = 2)) ;

commit ;

