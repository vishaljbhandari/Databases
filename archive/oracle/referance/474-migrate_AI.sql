-- AI : Start --

DELETE FROM AI_GROUPS ;
DELETE FROM AI_DISCRETIZATION_BANDS ;
DELETE FROM DEVIATED_CUM_DATA_ROC_RECORDS ;
DELETE FROM DEVIATED_CUM_VOICE_ROC_RECORDS ;

INSERT INTO AI_GROUPS(NAME) SELECT ID FROM AI_GROUPS@DU_NIKIRA ;
INSERT INTO AI_DISCRETIZATION_BANDS SELECT * FROM AI_DISCRETIZATION_BANDS@DU_NIKIRA ;

INSERT INTO DEVIATED_CUM_DATA_ROC_RECORDS
(
	ID, SUBSCRIBER_ID, PHONE_NUMBER, SERVICE_TYPE, ANI_PREFIX, CDR_TYPE, VALUE,
	DURATION, CALL_COUNT, VOLUME, ROC_DURATION_SNAP, ROC_VALUE_SNAP, ROC_CALLCOUNT_SNAP,
	ROC_VOLUME_SNAP, ROC_ELAPSED_DAY_LIST, TIME_STAMP, NETWORK_ID, DAY_OF_YEAR
)
SELECT
	ID, SUBSCRIBER_ID, PHONE_NUMBER, SERVICE_TYPE, ANI_PREFIX, CDR_TYPE, VALUE,
	DURATION, CALL_COUNT, VOLUME, ROC_DURATION_SNAP, ROC_VALUE_SNAP, ROC_CALLCOUNT_SNAP,
	ROC_VOLUME_SNAP, ROC_ELAPSED_DAY_LIST, TIME_STAMP, NETWORK_ID, TO_CHAR(TIME_STAMP, 'DDD')
FROM DEVIATED_CUM_DATA_ROC_RECORDS@DU_NIKIRA ;

INSERT INTO DEVIATED_CUM_VOICE_ROC_RECORDS
(
	ID, SUBSCRIBER_ID, PHONE_NUMBER, SERVICE_TYPE, CALL_TYPE, CDR_TYPE, VALUE, DURATION, CALL_COUNT, ROC_DURATION_SNAP,
	ROC_VALUE_SNAP, ROC_CALLCOUNT_SNAP, ROC_ELAPSED_DAY_LIST, TIME_STAMP, NETWORK_ID, DAY_OF_YEAR
)
SELECT
	ID, SUBSCRIBER_ID, PHONE_NUMBER, SERVICE_TYPE, CALL_TYPE, CDR_TYPE, VALUE, DURATION, CALL_COUNT, ROC_DURATION_SNAP,
	ROC_VALUE_SNAP, ROC_CALLCOUNT_SNAP, ROC_ELAPSED_DAY_LIST, TIME_STAMP, NETWORK_ID, TO_CHAR(TIME_STAMP, 'DDD')
FROM DEVIATED_CUM_VOICE_ROC_RECORDS@DU_NIKIRA ;

-- AI : End --

COMMIT;

EXIT;
