drop table TEMP_OFFLINE_IPDR ;
CREATE TABLE TEMP_OFFLINE_IPDR
(
	ID						NUMBER(20,0)					NOT	NULL,
	NETWORK_ID				NUMBER(20,0)					NOT	NULL,
	TIME_STAMP				DATE							NOT	NULL,
	DURATION				NUMBER(20,0)					NOT	NULL,
	PHONE_NUMBER			VARCHAR2(40),
	FRAMED_IP_ADDRESS		VARCHAR2(32),
	IPDR_TYPE				NUMBER(4,0)						NOT	NULL,
	UPLOAD_DATA_VOLUME		NUMBER(20,6)					NOT	NULL,
	DOWNLOAD_DATA_VOLUME	NUMBER(20,6)					NOT	NULL,
	ISP_QOS					NUMBER(20,0)					NOT	NULL,
	VALUE					NUMBER(16,6)					NOT	NULL,
	SUBSCRIBER_ID			NUMBER(20)						NOT	NULL,
	USER_NAME				VARCHAR2(256)					NOT	NULL,
	SESSION_ID				VARCHAR2(10)					NOT	NULL,
	SESSION_STATUS			NUMBER(2)						NOT	NULL,
	DAY_OF_YEAR				NUMBER(20,0),
	HOUR_OF_DAY				NUMBER(20,0)	DEFAULT	0
)
;

CREATE INDEX IX_TMP_OFFL_IPDR_PH_NU ON TEMP_OFFLINE_IPDR(PHONE_NUMBER)
;

drop table TEMP_SWAP_OFFLINE_IPDR ;
CREATE TABLE TEMP_SWAP_OFFLINE_IPDR COMPRESS AS SELECT * FROM TEMP_OFFLINE_IPDR WHERE 1=2 ;
CREATE INDEX IX_TE_SW_IPDR_PH_NU_0 ON TEMP_SWAP_OFFLINE_IPDR("PHONE_NUMBER") COMPRESS;

drop table TEMP_OFFLINE_RECH_LOG ;
CREATE TABLE TEMP_OFFLINE_RECH_LOG
(
	ID						NUMBER(20)						NOT	NULL,
	TIME_STAMP				DATE							NOT	NULL,
	PHONE_NUMBER			VARCHAR2(32),
	AMOUNT					NUMBER(16,6)					NOT	NULL,
	RECHARGE_TYPE			NUMBER(16,6)					NOT	NULL,
	STATUS					NUMBER(20)						NOT	NULL,
	CREDIT_CARD				VARCHAR2(80),
	PIN_NUMBER				VARCHAR2(40),
	SERIAL_NUMBER			VARCHAR2(40),
	NETWORK_ID				NUMBER(20)		DEFAULT	999		NOT	NULL,
	ACCOUNT_ID				NUMBER(20)						NOT	NULL,
	SUBSCRIBER_ID			NUMBER(20)						NOT	NULL,
	DAY_OF_YEAR				NUMBER(20,0)	DEFAULT	0,
	HOUR_OF_DAY				NUMBER(20,0)	DEFAULT	0
)
;

CREATE INDEX IX_TM_OFF_RECH_LOG_PH_NU ON TEMP_OFFLINE_RECH_LOG("PHONE_NUMBER")
;

CREATE INDEX IX_TM_OFF_RECH_LOG_PIN_NU ON TEMP_OFFLINE_RECH_LOG("PIN_NUMBER")
;

drop table TEMP_SWAP_OFFLINE_RECH_LOG ;
CREATE TABLE TEMP_SWAP_OFFLINE_RECH_LOG COMPRESS AS SELECT * FROM TEMP_OFFLINE_RECH_LOG WHERE 1=2 ;
CREATE INDEX IX_TE_SW_RH_PH_NU_0 ON TEMP_SWAP_OFFLINE_RECH_LOG("PHONE_NUMBER") COMPRESS;
CREATE INDEX IX_TE_SW_RH_PIN_NU_0 ON TEMP_SWAP_OFFLINE_RECH_LOG("PIN_NUMBER") COMPRESS ;

drop table TEMP_OFFLINE_GPRS_CDR ;
CREATE TABLE TEMP_OFFLINE_GPRS_CDR
(
	ID							NUMBER(20,0)					NOT	NULL,
	NETWORK_ID					NUMBER(20,0)					NOT	NULL,
	RECORD_TYPE					NUMBER(20,0)					NOT	NULL,
	TIME_STAMP					DATE							NOT	NULL,
	DURATION					NUMBER(20,0)					NOT	NULL,
	PHONE_NUMBER				VARCHAR2(32)					NOT	NULL,
	IMSI_NUMBER					VARCHAR2(32),
	IMEI_NUMBER					VARCHAR2(32),
	GEOGRAPHIC_POSITION			VARCHAR2(32),
	CDR_TYPE					NUMBER(20,0)					NOT	NULL,
	SERVICE_TYPE				NUMBER(20,0)					NOT	NULL,
	PDP_TYPE					VARCHAR2(32),
	SERVED_PDP_ADDRESS			VARCHAR2(32),
	UPLOAD_DATA_VOLUME			NUMBER(20,6)					NOT	NULL,
	DOWNLOAD_DATA_VOLUME		NUMBER(20,6)					NOT	NULL,
	SERVICE						NUMBER(20,0)	DEFAULT	2047,
	QOS_REQUESTED				NUMBER(20,0)					NOT	NULL,
	QOS_NEGOTIATED				NUMBER(20,0)					NOT	NULL,
	VALUE						NUMBER(16,6)					NOT	NULL,
	ACCESS_POINT_NAME			VARCHAR2(64),
	SUBSCRIBER_ID				NUMBER(20,0)					NOT	NULL,
	DAY_OF_YEAR					NUMBER(20,0)	DEFAULT 0,
	CAUSE_FOR_SESSION_CLOSING	NUMBER(2,0),
	SESSION_STATUS				NUMBER(2,0),
	CHARGING_ID					VARCHAR2(26)					NOT	NULL,
	ANI							VARCHAR2(32),
	HOUR_OF_DAY					NUMBER(20,0)	DEFAULT	0,
	VPMN						VARCHAR2(40)
)
;

CREATE INDEX IX_TMP_OFFL_GPRSCDR_PH_NU ON TEMP_OFFLINE_GPRS_CDR(PHONE_NUMBER)
;


drop table TEMP_SWAP_OFFLINE_GPRS_CDR ;
CREATE TABLE TEMP_SWAP_OFFLINE_GPRS_CDR COMPRESS AS SELECT * FROM OFFLINE_GPRS_CDR WHERE 1=2 ;
CREATE INDEX IX_TE_SW_GPRS_PH_NU_0 ON TEMP_SWAP_OFFLINE_GPRS_CDR("PHONE_NUMBER") COMPRESS;

drop table TEMP_OFFLINE_CDR ;
CREATE TABLE TEMP_OFFLINE_CDR
(
	ID							NUMBER(20,0)					NOT	NULL,
	NETWORK_ID					NUMBER(20,0)					NOT	NULL,
	CALLER_NUMBER				VARCHAR2(80),
	CALLED_NUMBER				VARCHAR2(80)					NOT	NULL,
	FORWARDED_NUMBER			VARCHAR2(80),
	RECORD_TYPE					NUMBER(20,0)					NOT	NULL,
	DURATION					NUMBER(20,0)					NOT	NULL,
	TIME_STAMP					DATE							NOT	NULL,
	EQUIPMENT_ID				VARCHAR2(40),
	IMSI_NUMBER					VARCHAR2(40),
	GEOGRAPHIC_POSITION			VARCHAR2(32),
	CALL_TYPE					NUMBER(20,0)					NOT	NULL,
	SUBSCRIBER_ID				NUMBER(20,0)					NOT	NULL,
	VALUE						NUMBER(16,6)					NOT	NULL,
	CDR_TYPE					NUMBER(20,0)					NOT	NULL,
	SERVICE_TYPE				NUMBER(20,0)					NOT	NULL,
	CDR_CATEGORY				NUMBER(20,0)	DEFAULT	1		NOT	NULL,
	IS_COMPLETE					NUMBER(20)						NOT	NULL,
	IS_ATTEMPTED				NUMBER(20)						NOT	NULL,
	SERVICE						NUMBER(20,0)	DEFAULT	2047,
	PHONE_NUMBER				VARCHAR2(80),
	DAY_OF_YEAR					NUMBER(20,0)	DEFAULT	0,
	HOUR_OF_DAY					NUMBER(20,0)	DEFAULT	0,
	OTHER_PARTY_COUNTRY_CODE	VARCHAR2(32),
	VPMN						VARCHAR2(40)
)
;

CREATE INDEX IX_TMP_OFFL_CDR_PH_NU ON TEMP_OFFLINE_CDR("PHONE_NUMBER")
;

CREATE INDEX IX_TMP_OFFL_CDR_CLR_NU ON TEMP_OFFLINE_CDR("CALLER_NUMBER")
;

CREATE INDEX IX_TMP_OFFL_CDR_CLD_NU ON TEMP_OFFLINE_CDR("CALLED_NUMBER")
;

drop table TEMP_SWAP_OFFLINE_CDR ;
CREATE TABLE TEMP_SWAP_OFFLINE_CDR COMPRESS AS SELECT * FROM OFFLINE_CDR WHERE 1=2 ;
CREATE INDEX IX_TE_SW_CDR_PH_NU_0 ON TEMP_SWAP_OFFLINE_CDR("PHONE_NUMBER") COMPRESS;
CREATE INDEX IX_TE_SW_CDR_CLR_NU_0 ON TEMP_SWAP_OFFLINE_CDR("CALLER_NUMBER") COMPRESS ;
CREATE INDEX IX_TE_SW_CDR_CLD_NU_0 ON TEMP_SWAP_OFFLINE_CDR("CALLED_NUMBER") COMPRESS;

create or replace view OFF_XDR_INDEX_MAP_V  as ( select u1.INDEX_NAME TEMP_INDEX, u2.INDEX_NAME SWAP_INDEX, u1.COLUMN_NAME COLUMN_NAME, u1.TABLE_NAME TEMP_TABLE, u2.TABLE_NAME SWAP_TABLE from  user_ind_columns u1 , user_ind_columns u2 where u1.COLUMN_NAME = u2.COLUMN_NAME and u1.TABLE_NAME in ( select TEMP_TABLE_NAME from XDR_OFFLINE_TEMP_MAPS ) and u2.TABLE_NAME in ( select SWAP_TABLE_NAME  from XDR_OFFLINE_TEMP_MAPS )) ;
