SET FEEDBACK OFF ;
SPOOL DSConfig-db.log

DROP TABLE DATASOURCE_INFO CASCADE CONSTRAINTS ;
DROP TABLE ASN1_CALLMODULE_PATH ;
DROP TABLE ASN1_FIELD_PATH ;
DROP TABLE ASN1_PARSER_CONFIGURATION ;
DROP TABLE DATE_FORMATTER ;
DROP TABLE MAP_FORMATTER ;
DROP TABLE TRIM_FORMATTER ;
DROP TABLE LTRIM_FORMATTER ;
DROP TABLE WIDTH_CHECK_FORMATTER ;
DROP TABLE WIDTH_TRUNC_FORMATTER ;
DROP TABLE REPLACE_FORMATTER ;
DROP TABLE DUPLICATE_FIELD_FORMATTER ;
DROP TABLE UNF_FORMATTER ;
DROP TABLE FORMATTER;
DROP TABLE DIVIDE_FORMATTER;
DROP TABLE VALIDATOR ;
DROP TABLE DS_FILTER ;
DROP TABLE PARSER CASCADE CONSTRAINTS ;
DROP TABLE ASCII_DELIMITED_FIELD_INFO ;
DROP TABLE ASCII_DELIMITED_PARSER_INFO ;
DROP TABLE OUTPUT_FORMAT ;
DROP TABLE BUSINESSRULE CASCADE CONSTRAINTS ;
DROP TABLE PARTIAL_CDR_CONFIGURATION ;
DROP TABLE CALL_TYPE_CONFIGURATION ;
DROP TABLE RATE_CONFIGURATION ;
DROP TABLE SUBSCRIBER_ID_CONFIGURATION ;
DROP TABLE MATCH_FIELD_FILTER ;
DROP TABLE MATCH_FIELD_CONSTANT_FILTER ;
DROP TABLE RFF_FIELD_POSITION_MAP ;
DROP TABLE LCA ;
DROP TABLE PREFIX_FILTER ;
DROP TABLE ROAM_LINE_RANGE ;
DROP TABLE MANIPULATOR CASCADE CONSTRAINTS ;
DROP TABLE DUPLICATE_FIELD_MANIP ;

DROP TABLE BDWRDW_BLOCK_CONFIGURATION CASCADE CONSTRAINTS ;
DROP TABLE BDWRDW_PARSER_CONFIGURATION CASCADE CONSTRAINTS ;
DROP TABLE BDWRDW_RECORD_CONFIGURATION CASCADE CONSTRAINTS ;
DROP TABLE BDWRDW_FIELD_CONFIGURATION ;

DROP TABLE EXPRESSION_RULE CASCADE CONSTRAINTS ;
DROP TABLE EXPRESSION_CONDITIONS CASCADE CONSTRAINTS ;
DROP TABLE EXPRESSION_EVALUATION_ACTIONS ;
DROP TABLE FIELD_ARITHMATIC_RULE CASCADE CONSTRAINTS ;
DROP TABLE FIELD_ARITHMATIC CASCADE CONSTRAINTS ;
DROP TABLE DATE_FORMAT ; 
DROP TABLE STRIP_PREFIX_BUSINESSRULE CASCADE CONSTRAINTS ; 
DROP TABLE REGEX_VALIDATOR ;
DROP TABLE RANGE_VALIDATOR CASCADE CONSTRAINTS ;
DROP TABLE DS_CONFIGURATION CASCADE CONSTRAINTS ;

CREATE TABLE DS_CONFIGURATION 
(
	ID		 VARCHAR2(50) NULL,
	VALUE	 VARCHAR2(500) NULL,
	CONSTRAINT PK_DS_CO_ID PRIMARY KEY (ID) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE DATASOURCE_INFO
(
	DATASOURCE_NAME 		VARCHAR2(40) NOT NULL,
	DS_TYPE				  	NUMBER(20) NOT NULL,
	CONSTRAINT PK_DS_IN PRIMARY KEY (DATASOURCE_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE OUTPUT_FORMAT
(
	DATASOURCE_NAME 		VARCHAR2(32) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	NUMBER_OF_FIELDS	  	NUMBER(20,0) NOT NULL,
	DELIMITER				VARCHAR2(32) NOT NULL,
	CONSTRAINT PK_OU_FO PRIMARY KEY (DATASOURCE_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE PARSER
(
	DATASOURCE_NAME 		VARCHAR2(32) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	PARSER_TYPE			  	NUMBER(20,0) NOT NULL,
	PARSER_NAME				VARCHAR2(32) UNIQUE NOT NULL,
	CONSTRAINT PK_PA PRIMARY KEY (DATASOURCE_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE ASCII_DELIMITED_PARSER_INFO
(
	PARSER_NAME				VARCHAR2(32) NOT NULL REFERENCES PARSER(PARSER_NAME) ON DELETE CASCADE,
	MAX_RECORD_LENGTH		NUMBER	(20) DEFAULT 1024,
	FIELD_DELIMITER			VARCHAR2(32) NOT NULL,
	HAS_HEADER			    VARCHAR2(1)  NOT NULL,	
	HAS_END_DELIMITER		VARCHAR2(1)  NOT NULL,
	CONSTRAINT PK_AS_DE_PA_IN PRIMARY KEY (PARSER_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE ASCII_DELIMITED_FIELD_INFO
(
	PARSER_NAME			VARCHAR2(32) NOT NULL REFERENCES PARSER(PARSER_NAME) ON DELETE CASCADE,
	FIELD_POSITION		NUMBER(20) NOT NULL,
	FIELD_NAME			VARCHAR2(50) NOT NULL,
	CONSTRAINT PK_AS_DE_FI_IN PRIMARY KEY (PARSER_NAME, FIELD_POSITION, FIELD_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE VALIDATOR
(
	 DATASOURCE_NAME         VARCHAR2(32) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	 FIELD_NAME				 VARCHAR2(50) NOT NULL,
	 SEQUENCE				 NUMBER(20,0) NOT NULL,
	 VALIDATOR_TYPE          NUMBER(20,0) NOT NULL,
	 VALIDATOR_NAME          VARCHAR2(50),
	 CONSTRAINT PK_VA PRIMARY KEY (DATASOURCE_NAME, FIELD_NAME, VALIDATOR_TYPE) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE BUSINESSRULE
(
	 DATASOURCE_NAME         VARCHAR2(32) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	 SEQUENCE				 NUMBER(20,0) NOT NULL,
	 BUSINESSRULE_TYPE       NUMBER(20,0) NOT NULL,
	 BUSINESSRULE_NAME       VARCHAR2(32) NOT NULL UNIQUE, 
     MODULE_NAME             VARCHAR2(256) NOT NULL,
	 CONSTRAINT PK_BU PRIMARY KEY (DATASOURCE_NAME, SEQUENCE, BUSINESSRULE_NAME) USING INDEX TABLESPACE TS_RANGER,
	 CONSTRAINT CK_BR_MOD_NAME CHECK (MODULE_NAME NOT LIKE 'lib%' AND MODULE_NAME NOT LIKE '%.so' AND MODULE_NAME NOT LIKE '%.sl')
) TABLESPACE TS_RANGER;

CREATE TABLE FORMATTER
(
	 DATASOURCE_NAME         VARCHAR2(32) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	 FIELD_NAME				 VARCHAR2(50) NOT NULL,
	 SEQUENCE				 NUMBER(20,0) NOT NULL,
	 FORMATTER_TYPE          NUMBER(20,0) NOT NULL,
	 FORMATTER_NAME			 VARCHAR2(50) NOT NULL,
	 CONSTRAINT PK_FO PRIMARY KEY (DATASOURCE_NAME, FIELD_NAME, FORMATTER_TYPE, FORMATTER_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE MANIPULATOR
(
	 DATASOURCE_NAME         VARCHAR2(32) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	 SEQUENCE				 NUMBER(20,0) NOT NULL,
	 MANIPULATOR_TYPE        NUMBER(20,0) NOT NULL,
	 MANIPULATOR_NAME		 VARCHAR2(50) NOT NULL UNIQUE,
	 CONSTRAINT PK_MA PRIMARY KEY (DATASOURCE_NAME, MANIPULATOR_TYPE, MANIPULATOR_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE DUPLICATE_FIELD_MANIP
(
	MANIPULATOR_NAME        VARCHAR2(50) NOT NULL REFERENCES MANIPULATOR(MANIPULATOR_NAME) ON DELETE CASCADE,
	FIELD_NAME              VARCHAR2(50) NOT NULL,
	NEW_FIELD_NAME			VARCHAR2(50) NOT NULL,
	CONSTRAINT PK_DU_FI_MA PRIMARY KEY (MANIPULATOR_NAME,FIELD_NAME,NEW_FIELD_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;	

CREATE TABLE MATCH_FIELD_CONSTANT_FILTER
(
	FILTER_NAME				VARCHAR2(50) NOT NULL,
	FIELD					VARCHAR2(50) NOT NULL,
	CONSTANT_VALUE		    VARCHAR2(50) NOT NULL,
	IS_ENABLED              VARCHAR2(1) NOT NULL,
	CONSTRAINT PK_MA_FI_CO_FI	PRIMARY KEY (FILTER_NAME, FIELD) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE MATCH_FIELD_FILTER
(
	FILTER_NAME				VARCHAR2(50) NOT NULL,
	FIELD					VARCHAR2(50) NOT NULL,
	FIELD_TO_MATCH		    VARCHAR2(50) NOT NULL,
	IS_ENABLED 				VARCHAR2(1) NOT NULL,
	CONSTRAINT PK_MA_FI PRIMARY KEY (FILTER_NAME, FIELD) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE DS_FILTER
(
	 DATASOURCE_NAME         VARCHAR2(32) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	 SEQUENCE				 NUMBER(20,0) NOT NULL,
	 FILTER_TYPE          	 NUMBER(20,0) NOT NULL,
	 FILTER_NAME			 VARCHAR2(50) NOT NULL,
	 LOG_REQUIRED			 VARCHAR2(1)  NOT NULL,
	 CONSTRAINT PK_DS_FI PRIMARY KEY (DATASOURCE_NAME, FILTER_TYPE, FILTER_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE PREFIX_FILTER
(
	FILTER_NAME             VARCHAR2(50) NOT NULL, 
	FIELD_NAME          	VARCHAR2(50) NOT NULL,
	PREFIX_TO_MATCH			VARCHAR2(20) NOT NULL,
	IS_ENABLED 				VARCHAR2(1) NOT NULL,
	CONSTRAINT PK_PR_FI PRIMARY KEY (FILTER_NAME, FIELD_NAME, PREFIX_TO_MATCH) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE PARTIAL_CDR_CONFIGURATION
(
	FILTER_NAME 			VARCHAR2(50) NOT NULL,
	FLUSH_INTERVAL			NUMBER		 NOT NULL,
	CALL_IDENTICATION		VARCHAR2(50) NOT NULL,
	DATE_FOR_START_OF_CALL	VARCHAR2(50) NOT NULL,
	TIME_FOR_START_OF_CALL	VARCHAR2(50) NOT NULL,
	PARTIAL_OUPUT_REC_NUM	VARCHAR2(50) NOT NULL,
	LAST_PARTIAL_OUTPUT		VARCHAR2(50) NOT NULL,
	DURATION				VARCHAR2(50) NOT NULL,
	TIME_STAMP				VARCHAR2(50) NOT NULL,
	IS_ATTEMPTED            VARCHAR2(50) NOT NULL,
    DATE_FORMAT             VARCHAR2(20) NOT NULL,
	CONSTRAINT PK_PA_CD_CO	PRIMARY KEY (FILTER_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE CALL_TYPE_CONFIGURATION 
(
	DATASOURCE_NAME 			VARCHAR2(32) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	LONG_DIST_PREFIX 			VARCHAR2(20) NOT NULL,
	RECORD_TYPE					VARCHAR2(50) NOT NULL,
	CALL_TYPE					VARCHAR2(50) NOT NULL,
	CALLER_NUMBER				VARCHAR2(50) NOT NULL,
	CALLED_NUMBER				VARCHAR2(50) NOT NULL,
	FORWARDED_NUMBER			VARCHAR2(50) NOT NULL,
	ORIG_RECORD_TYPE			VARCHAR2(50),
	TERM_RECORD_TYPE			VARCHAR2(50),
	CALL_FWD_RECORD_TYPE		VARCHAR2(50),
	ROAM_CALL_FWD_RECORD_TYPE   VARCHAR2(50),
	CONSTRAINT PK_CA_TY_CO	PRIMARY KEY (DATASOURCE_NAME)	USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE RATE_CONFIGURATION 
(
	DATASOURCE_NAME 			VARCHAR2(32) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	RECORD_TYPE					VARCHAR2(50) NOT NULL,
	TIME_STAMP					VARCHAR2(50) NOT NULL,
	DURATION					VARCHAR2(50) NOT NULL,
	CALLER_NUMBER				VARCHAR2(50) NOT NULL,
	CALLED_NUMBER				VARCHAR2(50) NOT NULL,
	FORWARDED_NUMBER			VARCHAR2(50) NOT NULL,
	SERVICE_TYPE				VARCHAR2(50) NOT NULL,
	NETWORK						VARCHAR2(50) NOT NULL,
	PHONE_NUMBER				VARCHAR2(50) NOT NULL,
	CALL_TYPE                   VARCHAR2(50) NOT NULL,
	VALUE						VARCHAR2(50) NOT NULL,
	SUBSCRIBER_ID				VARCHAR2(50) NOT NULL,
	CONSTRAINT PK_RA_CO PRIMARY KEY (DATASOURCE_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE SUBSCRIBER_ID_CONFIGURATION 
(
	DATASOURCE_NAME 			VARCHAR2(32) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	IMSI						VARCHAR2(50) NOT NULL,
	PHONE_NUMBER				VARCHAR2(50) NOT NULL,
	SUBSCRIBER_ID				VARCHAR2(50) NOT NULL,
	CONSTRAINT PK_SU_ID_CO PRIMARY KEY (DATASOURCE_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE UNF_FORMATTER
(
 	FORMATTER_NAME          VARCHAR2(50) NOT NULL,
	NUMBER_TO_MATCH			VARCHAR2(32) NOT NULL,
	CONVERT_TO_NUMBER		VARCHAR2(32),
	CONSTRAINT PK_UN_FO PRIMARY KEY (FORMATTER_NAME, NUMBER_TO_MATCH) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE TRIM_FORMATTER
(
 	FORMATTER_NAME          VARCHAR2(50) NOT NULL,
	TRIM_CHARS				VARCHAR2(32),
	CONSTRAINT PK_TR_FO	PRIMARY KEY (FORMATTER_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE LTRIM_FORMATTER
(
 	FORMATTER_NAME          VARCHAR2(50) NOT NULL,
	TRIM_STRING				VARCHAR2(32) NOT NULL,
	CONSTRAINT PK_LT_FO	PRIMARY KEY (FORMATTER_NAME, TRIM_STRING) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE WIDTH_CHECK_FORMATTER
(
    FORMATTER_NAME          VARCHAR2(50) NOT NULL,
    WIDTH              		NUMBER(10),
	CONSTRAINT PK_WI_CH_FO PRIMARY KEY (FORMATTER_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE WIDTH_TRUNC_FORMATTER
(
    FORMATTER_NAME          VARCHAR2(50) NOT NULL,
    WIDTH              		NUMBER(10),
	CONSTRAINT PK_WI_TR_FO PRIMARY KEY (FORMATTER_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE REPLACE_FORMATTER
(
 	FORMATTER_NAME          VARCHAR2(50) NOT NULL,
	MATCH_STRING			VARCHAR2(40) NOT NULL,
	REPLACE_STRING			VARCHAR2(40) 
) TABLESPACE TS_RANGER;

CREATE TABLE DUPLICATE_FIELD_FORMATTER
(
 	FORMATTER_NAME          VARCHAR2(50) NOT NULL,
	FIELD_NAME				VARCHAR2(40) NOT NULL,
	NEW_FIELD_NAME			VARCHAR2(40) NOT NULL 
) TABLESPACE TS_RANGER;

CREATE TABLE MAP_FORMATTER
(
 	FORMATTER_NAME          VARCHAR2(50) NOT NULL,
	FROM_VALUE				VARCHAR2(50) NOT NULL,
	TO_VALUE				VARCHAR2(50) NOT NULL,
	CONSTRAINT PK_MA_FO	PRIMARY KEY (FORMATTER_NAME, FROM_VALUE) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE DATE_FORMATTER
(
 	FORMATTER_NAME          VARCHAR2(50) NOT NULL,
	INPUT_FORMAT			VARCHAR2(32) NOT NULL,
	OUTPUT_FORMAT			VARCHAR2(32) NOT NULL,
	CONSTRAINT PK_DA_FO	PRIMARY KEY (FORMATTER_NAME, INPUT_FORMAT) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE DIVIDE_FORMATTER
(
	FORMATTER_NAME          VARCHAR2(50) NOT NULL,
	DIVISOR					NUMBER NOT NULL,
	CONSTRAINT PK_DI_FO PRIMARY KEY(FORMATTER_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE ASN1_CALLMODULE_PATH
(
    PARSER_NAME      VARCHAR2(40) NOT NULL REFERENCES PARSER(PARSER_NAME) ON DELETE CASCADE,
    CALL_MODULE      VARCHAR2(50) NOT NULL,
    CALL_MODULE_PATH VARCHAR2(15) NOT NULL,
	CONSTRAINT PK_AS_CA_PA	PRIMARY KEY (PARSER_NAME, CALL_MODULE) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE ASN1_FIELD_PATH
(
    CALL_MODULE     VARCHAR2(50) NOT NULL ,
    TAG_NAME        VARCHAR2(40) NOT NULL,
    TAG_CODE_PATH   VARCHAR2(15) NOT NULL ,
    TAG_TYPE        VARCHAR2(5) CHECK (TAG_TYPE IN ('T','TV','TLV')),
	CONSTRAINT PK_AS_FI_PA PRIMARY KEY (CALL_MODULE, TAG_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE ASN1_PARSER_CONFIGURATION
(
    PARSER_NAME 	VARCHAR2(40) NOT NULL REFERENCES PARSER(PARSER_NAME) ON DELETE CASCADE,
    ID 				VARCHAR2(50) NOT NULL,
    VALUE 			VARCHAR2(100) NOT NULL,
	CONSTRAINT PK_AS_PA_CO PRIMARY KEY (PARSER_NAME, ID) USING INDEX TABLESPACE TS_RANGER
)  TABLESPACE TS_RANGER;

CREATE TABLE RFF_FIELD_POSITION_MAP
(
	DATASOURCE_NAME     VARCHAR2(40) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,	
	FIELD_NAME		  	VARCHAR2(40) NOT NULL,
	FIELD_POSITION		NUMBER NOT NULL,
	DEFAULT_VALUE		VARCHAR2(40),
	CONSTRAINT PK_RF_FI_PO_MAP PRIMARY KEY (DATASOURCE_NAME, FIELD_POSITION) USING INDEX TABLESPACE TS_RANGER	
) TABLESPACE TS_RANGER;

CREATE TABLE BDWRDW_BLOCK_CONFIGURATION
(
    PARSER_NAME                     		VARCHAR2(40) NOT NULL REFERENCES PARSER(PARSER_NAME) ON DELETE CASCADE,
    BLOCK_NAME                      		VARCHAR2(32) UNIQUE NOT NULL,
    BLOCK_CODE                      		VARCHAR2(15) NOT NULL,
    BLOCK_SIZE                      		NUMBER(10)   NOT NULL,
    BLOCK_HEADER_SIZE               		NUMBER(3)    NOT NULL,
    RECORD_TYPE_OFFSET_POS_NIBS     		NUMBER(3)    NOT NULL,
    RECORD_TYPE_SIZE_NIBBLES           		NUMBER(4)    NOT NULL,
	CONSTRAINT PK_BD_BL_CO PRIMARY KEY (PARSER_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE BDWRDW_PARSER_CONFIGURATION
(
    PARSER_NAME     VARCHAR2(40) NOT NULL REFERENCES PARSER(PARSER_NAME) ON DELETE CASCADE,
    ID              VARCHAR2(50) NOT NULL,
    VALUE           VARCHAR2(100) NOT NULL,
	CONSTRAINT PK_BD_PA_CO	PRIMARY KEY (PARSER_NAME, ID)	USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE BDWRDW_RECORD_CONFIGURATION
(
    BLOCK_NAME      VARCHAR2(32) NOT NULL REFERENCES BDWRDW_BLOCK_CONFIGURATION(BLOCK_NAME) ON DELETE CASCADE,
    RECORD_NAME     VARCHAR2(32) NOT NULL,
    RECORD_CODE     VARCHAR2(32) NOT NULL,
    RECORD_SIZE     NUMBER(4) NOT NULL,
	SKIP_RECORD		VARCHAR(1) CHECK (SKIP_RECORD IN ('Y','N')),
	CONSTRAINT PK_BD_RE_CO PRIMARY KEY (RECORD_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE BDWRDW_FIELD_CONFIGURATION
(
    RECORD_NAME             VARCHAR2(32)  NOT NULL,
    FIELD_NAME              VARCHAR2(40) NOT NULL,
    FIELD_OFFSET_NIBBLES    NUMBER(4) NOT NULL,
    FIELD_SIZE_NIBBLES      NUMBER(4) NOT NULL,
	CONSTRAINT PK_BD_FI_CO PRIMARY KEY (RECORD_NAME, FIELD_NAME) USING INDEX TABLESPACE TS_RANGER,
	CONSTRAINT FK_BD_FI_CO FOREIGN KEY (RECORD_NAME) REFERENCES BDWRDW_RECORD_CONFIGURATION(RECORD_NAME) ON DELETE CASCADE
) TABLESPACE TS_RANGER;

CREATE TABLE LCA
(
	DATASOURCE_NAME     VARCHAR2(40) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	LCA_NUMBER			NUMBER NOT NULL,
	CONSTRAINT PK_LCA PRIMARY KEY (DATASOURCE_NAME, LCA_NUMBER) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE ROAM_LINE_RANGE
(
	DATASOURCE_NAME 	VARCHAR2(40) NOT NULL REFERENCES DATASOURCE_INFO(DATASOURCE_NAME) ON DELETE CASCADE,
	STARTING_NUMBER		VARCHAR2(40) NOT NULL,
	ENDING_NUMBER  		VARCHAR2(40) NOT NULL,
	CONSTRAINT PK_LR PRIMARY KEY (DATASOURCE_NAME, STARTING_NUMBER, ENDING_NUMBER) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;


CREATE TABLE EXPRESSION_RULE
(
	BUSINESSRULE_NAME   VARCHAR2(32) NOT NULL REFERENCES BUSINESSRULE(BUSINESSRULE_NAME) ON DELETE CASCADE,
    RULE_NAME		    VARCHAR2(50) NOT NULL,
	SEQUENCE            NUMBER(20,0) NOT NULL,
	CONSTRAINT PK_EX_RU PRIMARY KEY (RULE_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE EXPRESSION_CONDITIONS
(
	RULE_NAME           VARCHAR2(50) NOT NULL,
	SEQUENCE			NUMBER(20,0) NOT NULL,
	COMBINING_OPERATOR	VARCHAR2(10),
	BEGIN_GROUP_IND		VARCHAR2(1),
	FIELD_NAME			VARCHAR2(40),
	FIELD_TYPE			VARCHAR2(1),
	OPERATOR			VARCHAR2(10),
	VALUE				VARCHAR2(256),
	END_GROUP_IND		VARCHAR2(1),
	CONSTRAINT PK_EX_CO PRIMARY KEY (RULE_NAME, SEQUENCE) USING INDEX TABLESPACE TS_RANGER,
	CONSTRAINT FK_EX_CO_RU FOREIGN KEY (RULE_NAME) REFERENCES EXPRESSION_RULE(RULE_NAME) ON DELETE CASCADE
) TABLESPACE TS_RANGER;

CREATE TABLE EXPRESSION_EVALUATION_ACTIONS
(
	RULE_NAME           	VARCHAR2(50) NOT NULL,
	EVALUATION_CONDITION 	VARCHAR2(5) CHECK (EVALUATION_CONDITION IN ('IF','ELSE')),
	FIELD_NAME	 			VARCHAR2(40) NOT NULL,
	VALUE					VARCHAR2(256),
	CONSTRAINT FK_EX_EV_AC_RU FOREIGN KEY (RULE_NAME) REFERENCES EXPRESSION_RULE(RULE_NAME) ON DELETE CASCADE
) TABLESPACE TS_RANGER;
CREATE TABLE FIELD_ARITHMATIC_RULE
(
	BUSINESSRULE_NAME   VARCHAR2(32) NOT NULL REFERENCES BUSINESSRULE(BUSINESSRULE_NAME) ON DELETE CASCADE,
    RULE_NAME           VARCHAR2(50) NOT NULL,
    SEQUENCE            NUMBER(20,0) NOT NULL,
	CONSTRAINT PK_FI_AR_RU PRIMARY KEY (RULE_NAME) USING INDEX TABLESPACE TS_RANGER
)TABLESPACE TS_RANGER ;
CREATE TABLE FIELD_ARITHMATIC
(
	RULE_NAME	            VARCHAR2(50) NOT NULL REFERENCES FIELD_ARITHMATIC_RULE(RULE_NAME) ON DELETE CASCADE,	
	OPERATOR				VARCHAR2(5) NOT NULL,
	OPERAND_TYPE			VARCHAR2(2) NOT NULL,
	FIELD1					VARCHAR2(40) NOT NULL,
	FIELD2					VARCHAR2(40) NOT NULL,
	OUTPUT_FIELD			VARCHAR2(40) NOT NULL,
	FORMAT_LOOKUP_ID		NUMBER(15,0),
	CONSTRAINT PK_FI_AR PRIMARY KEY (RULE_NAME) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;
CREATE TABLE DATE_FORMAT
(
	FORMAT_LOOKUP_ID        NUMBER(15,0),
	FIELD1_FORMAT			VARCHAR2(25),
	FIELD2_FORMAT			VARCHAR2(2),
	OUTPUT_FIELD_FORMAT		VARCHAR2(25),
	CONSTRAINT PK_DATE_FO PRIMARY KEY (FORMAT_LOOKUP_ID) USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE STRIP_PREFIX_BUSINESSRULE
(
	BUSINESSRULE_NAME   VARCHAR2(32) NOT NULL REFERENCES BUSINESSRULE(BUSINESSRULE_NAME) ON DELETE CASCADE,
	FIELD_NAME        	VARCHAR2(40) NOT NULL,
	PREFIX_TO_STRIP     VARCHAR2(32) NOT NULL,
	CONSTRAINT PK_ST_PR_BU PRIMARY KEY (BUSINESSRULE_NAME, FIELD_NAME, PREFIX_TO_STRIP)	 USING INDEX TABLESPACE TS_RANGER
) TABLESPACE TS_RANGER;

CREATE TABLE REGEX_VALIDATOR
(
     VALIDATOR_NAME          VARCHAR2(50) NOT NULL,
     SEQUENCE                NUMBER(20,0) NOT NULL,
     PATTERN                 VARCHAR2(1024) NOT NULL
) TABLESPACE TS_RANGER;

CREATE TABLE RANGE_VALIDATOR
(
	 VALIDATOR_NAME          VARCHAR2(50) , 
	 MIN_RANGE				 VARCHAR2(255) NOT NULL,
	 MAX_RANGE				 VARCHAR2(255) NOT NULL,
	 DATATYPE				 NUMBER(3) NOT NULL,
	 CONSTRAINT PK_RA_VA PRIMARY KEY (VALIDATOR_NAME)  USING INDEX TABLESPACE TS_RANGER  	
) TABLESPACE TS_RANGER;

quit;	
