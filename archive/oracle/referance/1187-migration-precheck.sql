---CREATE NEW TABLE SCHEMA AS TEMP ---
CREATE TABLE MIG_MATCHED_DETAILS
(
 	ID							NUMBER(20,0)	NOT NULL,
 	MATCHED_RESULTS_ID			NUMBER(20,0)    NOT NULL,
	MATCHED_RECORD				NUMBER(20,0)   	NOT NULL,
	FIELD_IDS					VARCHAR2(1024)  NOT NULL,
	FIELD_VALUES				VARCHAR2(4000),
	MATCH_TYPES					VARCHAR2(512),
	CONSTRAINT CK_TMP_MA_DE_MA_RE CHECK (MATCHED_RECORD BETWEEN 0 AND 1),
	CONSTRAINT PK_TMP_MA_DE_ID PRIMARY KEY (ID),
	CONSTRAINT FK_TMP_MA_DE_MA_RE_ID FOREIGN KEY(MATCHED_RESULTS_ID) REFERENCES MATCHED_RESULTS(ID)
) ;

CREATE TABLE MIG_ARCHIVED_MATCHED_DETAILS
(
 	MATCHED_RESULTS_ID			NUMBER(20,0)    NOT NULL,
	MATCHED_RECORD				NUMBER(20,0)   	NOT NULL,
	FIELD_IDS					VARCHAR2(1024)  NOT NULL,
	FIELD_VALUES				VARCHAR2(4000),
	MATCH_TYPES					VARCHAR2(512),
	CONSTRAINT CK_TMP_AR_MA_DE_MA_RE CHECK (MATCHED_RECORD BETWEEN 0 AND 1)
) ;


--- LOAD DATA FROM ACTUAL TABLE TO TEMP TABLE ---
@ precheck_migration_package.sql
execute  MigratePrecheckMatchedRecords.Migrate ;
@ archive_precheck_migration_package.sql
execute  ArchiveMigratePrecheckRecords.ArchiveMigrate ;
-- DROP OLD TABLES ----

DROP TABLE MATCHED_DETAILS ;
DROP TABLE ARCHIVED_MATCHED_DETAILS ;

-- RENAME TEMP TABLE  ---

ALTER TABLE MIG_MATCHED_DETAILS 
RENAME TO MATCHED_DETAILS ;

ALTER TABLE MIG_ARCHIVED_MATCHED_DETAILS 
RENAME TO ARCHIVED_MATCHED_DETAILS ;

